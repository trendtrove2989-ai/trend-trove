<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Trend Trove | Premium Hoodies & Track Suits | Online Shopping Pakistan</title>
    <meta name="description" content="Shop the best collection of men's hoodies, oversized track suits, and winter fleece joggers in Pakistan. Premium quality, affordable prices, and Cash on Delivery available via Trend Trove.">
    <meta name="keywords" content="hoodies pakistan, track suits for men, winter collection 2025, fleece hoodies, oversized tracksuits, online shopping pakistan, Trend Trove, men's fashion">
    <meta name="robots" content="index, follow">
    
    <meta property="og:title" content="Premium Hoodies & Track Suits - Trend Trove">
    <meta property="og:description" content="Discover the ultimate comfort with our premium track suits and hoodies. Shop now for the best winter wear in Pakistan.">
    <meta property="og:image" content="https://i.postimg.cc/c1jC3WGV/1.png">
    <meta property="og:url" content="https://trend-trove.pages.dev/">
    <meta property="og:type" content="website">
     
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-E8MBD8F49D"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
     
        gtag('config', 'G-E8MBD8F49D');
    </script>
    <link rel="icon" type="image/png" href="https://i.ibb.co/JWVdpGSj/Untitled-design.png">
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/@emailjs/browser@3/dist/email.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:wght@300;400;500;600;700&family=Inter:wght@300;400;500;600&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js" defer></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<style>
    /* Loading Animation Styles */
    .transition-overlay {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        z-index: 9999;
        pointer-events: none;
    }
    .music-btn {
        position: fixed;
        bottom: 20px;
        left: 20px; /* Using left so it doesn't overlap WhatsApp/Chat widgets usually on right */
        z-index: 9999;
        width: 40px;
        height: 40px;
        background: #d4af37; /* Gold */
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        box-shadow: 0 4px 10px rgba(0,0,0,0.3);
    }
    .shutter {
        position: absolute;
        top: 0;
        width: 50%;
        height: 100%;
        background-color: #ffffff;
        transition: transform 0.8s cubic-bezier(0.65, 0, 0.35, 1);
        display: flex;
        align-items: center;
    }

    .shutter-left {
        left: 0;
        transform: translateX(-100%);
        justify-content: flex-end;
    }

    .shutter-right {
        right: 0;
        transform: translateX(100%);
        justify-content: flex-start;
    }

    .logo-container {
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 3rem;
        width: 400px;
        position: relative;
    }

    .split-logo {
        display: flex;
        width: 100%;
        position: relative;
        justify-content: center;
    }

    .logo-wrapper {
        width: 200px;
        height: 400px;
        position: relative;
        overflow: hidden;
    }

    .shutter-left .logo-wrapper {
        margin-right: -200px;
    }

    .shutter-right .logo-wrapper {
        margin-left: -200px;
    }

    .logo-image {
        width: 200px;
        height: 400px;
        object-fit: cover;
    }

    .loader-container {
        position: absolute;
        bottom: 80px;
        width: 100%;
        display: flex;
        justify-content: center;
        opacity: 0;
        transition: opacity 0.3s ease;
    }

    .loader-container.active {
        opacity: 1;
    }

    .newtons-cradle {
        --uib-size: 80px;
        --uib-speed: 1.2s;
        --uib-color: #d1c98e;
        position: relative;
        display: flex;
        align-items: center;
        justify-content: center;
        width: var(--uib-size);
        height: var(--uib-size);
    }

    .newtons-cradle__dot {
        position: relative;
        display: flex;
        align-items: center;
        height: 100%;
        width: 25%;
        transform-origin: center top;
    }

    .newtons-cradle__dot::after {
        content: '';
        display: block;
        width: 100%;
        height: 25%;
        border-radius: 50%;
        background-color: var(--uib-color);
    }

    .newtons-cradle__dot:first-child {
        animation: swing var(--uib-speed) linear infinite;
    }

    .newtons-cradle__dot:last-child {
        animation: swing2 var(--uib-speed) linear infinite;
    }

    @keyframes swing {
        0% {
            transform: rotate(0deg);
            animation-timing-function: ease-out;
        }
        25% {
            transform: rotate(70deg);
            animation-timing-function: ease-in;
        }
        50% {
            transform: rotate(0deg);
            animation-timing-function: linear;
        }
    }

    @keyframes swing2 {
        0% {
            transform: rotate(0deg);
            animation-timing-function: linear;
        }
        50% {
            transform: rotate(0deg);
            animation-timing-function: ease-out;
        }
        75% {
            transform: rotate(-70deg);
            animation-timing-function: ease-in;
        }
    }

    .transition-overlay.active .shutter-left {
        transform: translateX(0);
    }

    .transition-overlay.active .shutter-right {
        transform: translateX(0);
    }

    .transition-overlay.closing .shutter-left {
        transform: translateX(-100%);
    }

    .transition-overlay.closing .shutter-right {
        transform: translateX(100%);
    }

    /* Page visibility control */
    .page-container {
        display: none;
    }

    .page-container.active {
        display: block;
    }

/* REPLACE your existing @media (max-width: 768px) and (max-width: 480px) with this: */
    @media (max-width: 768px) {
        .logo-container {
            width: auto; /* Allow container to shrink to content */
            gap: 0;      /* Remove gap to ensure perfect seam */
        }
        
        .logo-wrapper {
            /* Fixed dimensions ensure stability on all mobile screens */
            width: 120px; 
            height: 240px;
            max-width: none;
            max-height: none;
        }
        
        /* THE FIX: Set margins to 0 so images stop exactly at the center seam */
        .shutter-left .logo-wrapper {
            margin-right: 0;
        }
        
        .shutter-right .logo-wrapper {
            margin-left: 0;
        }
        
        .logo-image {
            width: 100%;
            height: 100%;
            object-fit: contain;
        }
        
        .newtons-cradle {
            --uib-size: 50px;
        }
        
        .loader-container {
            bottom: 15%; /* Adjusted for better mobile positioning */
        }
        
        /* Adjust Hero section specifically for mobile to prevent navbar overlap */
        .hero-height {
            height: 100vh;
            min-height: 100vh;
            margin-top: -60px; /* Matches mobile navbar height */
            padding-top: 60px;
        }
    }

    /* Rest of your existing CSS styles */
    .hero-height img {
         filter: brightness(100%);
    } 
    
    :root {
        --primary: #1a1a1a;
        --accent: #d4af37;
        --background: #fffef8;
        --text-heading: #2c2c2c;
        --text-description: #555555;
        --text-light: #ffffff;
        --text-muted: #777777;
        --text-gold: #d4af37;
        --highlight: #f8f9fa;
        --card-bg: #ffffff;
        --border-light: #eaeaea;
    }
    
    * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
    }

    .hero-height {
        height: 100vh;
        min-height: 100vh;
        position: relative;
    }

    .hero-height img {
        width: 100%;
        height: 100%;
        object-fit: cover;
        object-position: center;
    }

    @media (max-width: 768px) {
        .hero-height {
            height: 100vh;
            min-height: 100vh;
            margin-top: -70px;
            padding-top: 70px;
        }
    }

    @media (max-width: 480px) {
        .hero-height {
            margin-top: -60px;
            padding-top: 60px;
        }
    }    
    
    body {
        font-family: 'Inter', sans-serif;
        background-color: var(--background);
        color: var(--text-description);
        overflow-x: hidden;
        margin: 0;
        padding: 0;
        line-height: 1.6;
        padding-top: 80px;
    }
    
    /* ... (ALL YOUR EXISTING CSS STYLES REMAIN THE SAME) ... */
    
    /* Keep all your existing CSS below this point */
    .premium-border {
        border: 1px solid rgba(212, 175, 55, 0.3);
    }
    
    .premium-shadow {
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.08);
    }
    
    .gold-gradient {
        background: linear-gradient(135deg, var(--accent) 0%, #b8860b 100%);
    }
    
    .bg-cream {
        background-color: var(--background);
    }
    
    .bg-highlight {
        background-color: var(--highlight);
    }
    
    .section-padding {
        padding: 5rem 0;
    }
    
    .hero-height {
        height: 100vh;
        min-height: 700px;
    }
    
    .product-card {
        transition: all 0.4s ease;
        position: relative;
        overflow: hidden;
    }
    
    .product-card:hover {
        transform: translateY(-10px);
        box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
    }
    
    .product-image {
        transition: transform 0.8s ease;
    }
    
    .product-card:hover .product-image {
        transform: scale(1.05);
    }
    
    .overlay {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.4);
        opacity: 0;
        transition: opacity 0.4s ease;
        display: flex;
        align-items: center;
        justify-content: center;
    }
    
    .product-card:hover .overlay {
        opacity: 1;
    }
    
    .btn-premium {
        background: var(--primary);
        color: white;
        padding: 12px 30px;
        border: none;
        font-weight: 500;
        letter-spacing: 1px;
        transition: all 0.3s ease;
        position: relative;
        overflow: hidden;
    }
    
    .btn-premium:hover {
        background: var(--accent);
        color: var(--primary);
    }
    
    .btn-gold {
        background: var(--accent);
        color: var(--primary);
        padding: 12px 30px;
        border: none;
        font-weight: 500;
        letter-spacing: 1px;
        transition: all 0.3s ease;
    }
    
    .btn-gold:hover {
        background: var(--primary);
        color: white;
    }
    
    .nav-link {
        position: relative;
        padding: 5px 0;
    }
    
    .nav-link:after {
        content: '';
        position: absolute;
        bottom: 0;
        left: 0;
        width: 0;
        height: 1px;
        background: var(--accent);
        transition: width 0.3s ease;
    }
    
    .nav-link:hover:after {
        width: 100%;
    }
    
    .fade-in {
        opacity: 0;
        transform: translateY(30px);
        transition: all 0.8s ease;
    }
    
    .fade-in.visible {
        opacity: 1;
        transform: translateY(0);
    }
    
    /* Replace with this */
    .sticky-nav {
        position: fixed;
        top: 0;
        width: 100%;
        z-index: 1000;
        background: transparent; /* Start transparent */
        transition: all 0.3s ease;
        height: 80px;
    }
    
    /* Add this new class for the scrolling state */
    .sticky-nav.scrolled {
        background: rgba(255, 255, 255, 0.95);
        backdrop-filter: blur(10px);
        box-shadow: 0 5px 20px rgba(0, 0, 0, 0.05);
    }
    
    .logo {
        font-family: 'Cormorant Garamond', serif;
        font-weight: 600;
        font-size: 1.8rem;
        letter-spacing: 2px;
    }
    .collection-card {
        position: relative;
        height: 500px;
        overflow: hidden;
        cursor: pointer; /* Indicates it's tappable on mobile */
    }
    
    .collection-overlay {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        /* This creates the "Dark Dim" effect */
        background: rgba(0, 0, 0, 0.6); 
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        color: white;
        opacity: 0;
        transition: all 0.4s ease;
        backdrop-filter: blur(2px); /* Optional: adds a slight blur for premium feel */
    }
    
    .collection-card:hover .collection-overlay {
        opacity: 1;
    }
    
    .collection-card:hover .collection-image {
        transform: scale(1.1);
    }
    .collection-card:hover .static-collection-label {
        opacity: 0; /* Hides the default text so it doesn't overlap */
    }    
    .collection-image {
        transition: transform 0.8s ease;
        height: 100%;
        width: 100%;
        object-fit: cover;
    }
    .static-collection-label {
        position: absolute;
        bottom: 20px;
        left: 20px;
        z-index: 10;
        color: white;
        text-shadow: 0 2px 4px rgba(0,0,0,0.7);
        transition: opacity 0.3s ease;
        pointer-events: none; /* Let clicks pass through to the card */
    }
    
    .static-collection-label h3 {
        font-size: 2rem;
        font-family: 'Cormorant Garamond', serif;
        font-weight: 700;
        letter-spacing: 1px;
    }    
    .testimonial-card {
        background: white;
        padding: 2rem;
        border-radius: 5px;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.05);
        transition: all 0.3s ease;
    }
    
    .testimonial-card:hover {
        transform: translateY(-10px);
        box-shadow: 0 15px 40px rgba(0, 0, 0, 0.1);
    }
    
    .newsletter-input {
        background: white;
        border: 1px solid #e0e0e0;
        padding: 15px 20px;
        width: 100%;
        font-size: 1rem;
        transition: all 0.3s ease;
    }
    
    .newsletter-input:focus {
        outline: none;
        border-color: var(--accent);
    }
    
    .footer-link {
        transition: all 0.3s ease;
        display: inline-block;
    }
    
    .footer-link:hover {
        color: var(--accent);
        transform: translateX(5px);
    }
    
    @keyframes float {
        0% { transform: translateY(0px); }
        50% { transform: translateY(-10px); }
        100% { transform: translateY(0px); }
    }
    
    .floating {
        animation: float 5s ease-in-out infinite;
    }
    
    .scroll-indicator {
        position: absolute;
        bottom: 30px;
        left: 50%;
        transform: translateX(-50%);
        width: 30px;
        height: 50px;
        border: 2px solid var(--accent);
        border-radius: 15px;
        display: flex;
        justify-content: center;
    }
    
    .scroll-indicator:before {
        content: '';
        position: absolute;
        top: 10px;
        width: 4px;
        height: 10px;
        background: var(--accent);
        border-radius: 2px;
        animation: scroll 2s infinite;
    }
    
    @keyframes scroll {
        0% { transform: translateY(0); opacity: 1; }
        100% { transform: translateY(15px); opacity: 0; }
    }
    
    .modal-overlay {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.8);
        display: flex;
        align-items: center;
        justify-content: center;
        z-index: 2000;
        opacity: 0;
        visibility: hidden;
        transition: all 0.4s ease;
    }
    
    .modal-overlay.active {
        opacity: 1;
        visibility: visible;
    }
    
    .modal-content {
        background: white;
        width: 90%;
        max-width: 500px;
        border-radius: 10px;
        padding: 2rem;
        transform: scale(0.9);
        transition: all 0.4s ease;
        position: relative;
    }
    
    .modal-overlay.active .modal-content {
        transform: scale(1);
    }
    
    .close-modal {
        position: absolute;
        top: 15px;
        right: 15px;
        background: none;
        border: none;
        font-size: 1.5rem;
        cursor: pointer;
        color: var(--text-description);
    }
    
    .size-option {
        display: inline-block;
        padding: 10px 15px;
        border: 1px solid #e0e0e0;
        margin: 5px;
        cursor: pointer;
        transition: all 0.3s ease;
        border-radius: 5px;
    }
    
    .size-option:hover, .size-option.active {
        background: var(--primary);
        color: white;
        border-color: var(--primary);
        transform: scale(1.05);
    }
    
    /* Professional Toast Notification */
    .toast-container {
        position: fixed;
        top: 100px; /* Below navbar */
        right: 20px;
        z-index: 3000;
        display: flex;
        flex-direction: column;
        gap: 10px;
    }
    
    .toast {
        background: white;
        min-width: 300px;
        padding: 16px 20px;
        border-radius: 8px;
        box-shadow: 0 10px 25px rgba(0,0,0,0.15);
        display: flex;
        align-items: center;
        transform: translateX(120%);
        transition: transform 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        border-left: 4px solid var(--accent);
    }
    
    .toast.active {
        transform: translateX(0);
    }
    
    .toast.error {
        border-left-color: #dc3545;
    }
    
    .toast.success {
        border-left-color: #28a745;
    }
    
    .toast-icon {
        font-size: 1.2rem;
        margin-right: 12px;
    }
    
    .toast-content h4 {
        font-weight: 600;
        font-size: 0.95rem;
        color: var(--primary);
        margin-bottom: 2px;
    }
    
    .toast-content p {
        font-size: 0.85rem;
        color: #666;
        margin: 0;
    }
    
    /* Shake Animation for Validation */
    @keyframes shake {
        0%, 100% { transform: translateX(0); }
        10%, 30%, 50%, 70%, 90% { transform: translateX(-5px); }
        20%, 40%, 60%, 80% { transform: translateX(5px); }
    }
    
    .shake-element {
        animation: shake 0.5s ease-in-out;
        border-color: #dc3545 !important;
    }
    
    .loading-bar {
        position: fixed;
        top: 0;
        left: 0;
        height: 3px;
        background: var(--accent);
        width: 0%;
        z-index: 2000;
        transition: width 0.3s ease;
    }
    
    .admin-panel {
        background: var(--primary);
        color: white;
        padding: 10px 0;
        position: fixed;
        top: 0;
        width: 100%;
        z-index: 1001;
    }
    
    .page-transition {
        animation: fadeIn 0.5s ease-in-out;
    }
    
    @keyframes fadeIn {
        from { opacity: 0; transform: translateY(10px); }
        to { opacity: 1; transform: translateY(0); }
    }
    
    .image-hover-container {
        position: relative;
        overflow: hidden;
    }
    
    .image-hover-container img {
        transition: opacity 1.5s ease;
    }
    
    .image-hover-container:hover img {
        opacity: 0;
    }
    
    .image-hover-container .hover-image {
        position: absolute;
        top: 0;
        left: 0;
        opacity: 0;
        transition: opacity 1.5s ease;
    }
    
    .image-hover-container:hover .hover-image {
        opacity: 1;
    }
    
    .banner-slide {
        opacity: 0;
        transition: opacity 1s ease-in-out;
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
    }
    
    .banner-slide.active {
        opacity: 1;
    }
    
    .cart-sidebar {
        position: fixed;
        top: 0;
        right: -400px;
        width: 400px;
        height: 100vh;
        background: white;
        box-shadow: -5px 0 15px rgba(0, 0, 0, 0.1);
        z-index: 1500;
        transition: right 0.4s ease;
        overflow-y: auto;
    }
    
    .cart-sidebar.active {
        right: 0;
    }
    
    .cart-overlay {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.5);
        z-index: 1400;
        opacity: 0;
        visibility: hidden;
        transition: all 0.4s ease;
    }
    
    .cart-overlay.active {
        opacity: 1;
        visibility: visible;
    }
    
    /* Enhanced Animations */
    @keyframes slideInFromLeft {
        0% { transform: translateX(-100%); opacity: 0; }
        100% { transform: translateX(0); opacity: 1; }
    }
    
    @keyframes slideInFromRight {
        0% { transform: translateX(100%); opacity: 0; }
        100% { transform: translateX(0); opacity: 1; }
    }
    
    @keyframes pulse {
        0% { transform: scale(1); }
        50% { transform: scale(1.05); }
        100% { transform: scale(1); }
    }
    
    .animate-slide-left {
        animation: slideInFromLeft 0.8s ease-out;
    }
    
    .animate-slide-right {
        animation: slideInFromRight 0.8s ease-out;
    }
    
    .animate-pulse-slow {
        animation: pulse 3s infinite;
    }
    
    .parallax-bg {
        background-attachment: fixed;
        background-position: center;
        background-repeat: no-repeat;
        background-size: cover;
    }
    
    .premium-glow {
        box-shadow: 0 0 20px rgba(212, 175, 55, 0.3);
    }
    
    .morph-shape {
        border-radius: 60% 40% 30% 70% / 60% 30% 70% 40%;
        animation: morph 8s ease-in-out infinite;
    }
    
    @keyframes morph {
        0% { border-radius: 60% 40% 30% 70% / 60% 30% 70% 40%; }
        50% { border-radius: 30% 60% 70% 40% / 50% 60% 30% 60%; }
        100% { border-radius: 60% 40% 30% 70% / 60% 30% 70% 40%; }
    }
    
    .stagger-animation > * {
        opacity: 0;
        transform: translateY(20px);
        animation: fadeInUp 0.6s forwards;
    }
    
    .stagger-animation > *:nth-child(1) { animation-delay: 0.1s; }
    .stagger-animation > *:nth-child(2) { animation-delay: 0.2s; }
    .stagger-animation > *:nth-child(3) { animation-delay: 0.3s; }
    .stagger-animation > *:nth-child(4) { animation-delay: 0.4s; }
    .stagger-animation > *:nth-child(5) { animation-delay: 0.5s; }
    
    @keyframes fadeInUp {
        to {
            opacity: 1;
            transform: translateY(0);
        }
    }
    
    .hover-lift {
        transition: transform 0.3s ease, box-shadow 0.3s ease;
    }
    
    .hover-lift:hover {
        transform: translateY(-5px);
        box-shadow: 0 10px 25px rgba(0,0,0,0.1);
    }
    
    .gradient-border {
        position: relative;
        background: white;
        border-radius: 10px;
        padding: 1px;
    }
    
    .gradient-border::before {
        content: '';
        position: absolute;
        top: -2px;
        left: -2px;
        right: -2px;
        bottom: -2px;
        background: linear-gradient(45deg, var(--accent), transparent, var(--accent));
        border-radius: 12px;
        z-index: -1;
        opacity: 0;
        transition: opacity 0.3s ease;
    }
    
    .gradient-border:hover::before {
        opacity: 1;
    }
    
    /* Admin Dashboard Styles */
    .admin-dashboard {
        min-height: 100vh;
        background: var(--background);
        padding-top: 100px;
    }
    
    .admin-table {
        width: 100%;
        border-collapse: collapse;
        background: white;
        border-radius: 10px;
        overflow: hidden;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.05);
    }
    
    .admin-table th {
        background: var(--primary);
        color: white;
        padding: 15px;
        text-align: left;
        font-weight: 600;
    }
    
    .admin-table td {
        padding: 15px;
        border-bottom: 1px solid #eee;
    }
    
    .admin-table tr:hover {
        background: #f9f9f9;
    }
    
    .stock-badge {
        display: inline-block;
        padding: 4px 8px;
        border-radius: 4px;
        font-size: 0.8rem;
        font-weight: 600;
    }
    
    .stock-low {
        background: #fff3cd;
        color: #856404;
    }
    
    .stock-medium {
        background: #d1ecf1;
        color: #0c5460;
    }
    
    .stock-high {
        background: #d4edda;
        color: #155724;
    }
    
    .stock-out {
        background: #f8d7da;
        color: #721c24;
    }
    
    .sale-price {
        color: var(--accent);
        font-weight: bold;
    }
    
    .original-price {
        text-decoration: line-through;
        color: #999;
        font-size: 0.9rem;
    }
    
    .discount-badge {
        background: #dc3545;
        color: white;
        padding: 3px 8px;
        border-radius: 4px;
        font-size: 0.8rem;
        font-weight: bold;
        margin-left: 8px;
    }
    
    /* Size and Color Selection Styles */
    .size-option {
        display: inline-block;
        padding: 10px 15px;
        border: 2px solid #000;
        margin: 5px;
        cursor: pointer;
        transition: all 0.3s ease;
        border-radius: 5px;
        background-color: white;
        color: #000;
    }
    
    .size-option:hover, .size-option.active {
        background: #000;
        color: white;
        border-color: #000;
        transform: scale(1.05);
    }
    
    .color-option {
        display: inline-block;
        width: 40px;
        height: 40px;
        border-radius: 50%;
        margin: 5px;
        cursor: pointer;
        transition: all 0.3s ease;
        border: 2px solid #e0e0e0;
        position: relative;
    }
    
    .color-option:hover, .color-option.active {
        transform: scale(1.1);
        border-color: #000;
    }
    
    .color-option.active::after {
        content: 'âœ“';
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        color: white;
        font-weight: bold;
        text-shadow: 0 0 2px rgba(0,0,0,0.5);
    }
    
    /* Mobile Responsiveness Improvements */
    @media (max-width: 768px) {
        body {
            padding-top: 70px;
        }
        
        .sticky-nav {
            height: 70px;
        }
        
        .hero-height {
            height: 70vh;
            min-height: 500px;
        }
        
        .section-padding {
            padding: 3rem 0;
        }
        
        .collection-card {
            height: 300px;
        }
        
        .cart-sidebar {
            width: 100%;
            right: -100%;
        }
        
        .admin-table {
            display: block;
            overflow-x: auto;
        }
        
        h1 {
            font-size: 2.5rem;
        }
        
        h2 {
            font-size: 2rem;
        }
        
        .hero-height h1 {
            font-size: 2.5rem;
        }
        
        .hero-height p {
            font-size: 1.1rem;
        }
        
        .product-card h3 {
            font-size: 1.2rem;
        }
        
        .btn-premium, .btn-gold {
            padding: 10px 20px;
            font-size: 0.9rem;
        }
        
        .logo {
            font-size: 1.5rem;
        }
        
        .nav-link {
            font-size: 1rem;
            padding: 10px 0;
        }
    }
    
    @media (max-width: 480px) {
        body {
            padding-top: 60px;
        }
        
        .sticky-nav {
            height: 60px;
        }
        
        .hero-height {
            height: 60vh;
            min-height: 400px;
        }
        
        h1 {
            font-size: 2rem;
        }
        
        h2 {
            font-size: 1.8rem;
        }
        
        .hero-height h1 {
            font-size: 2rem;
        }
        
        .hero-height p {
            font-size: 1rem;
        }
        
        .product-card h3 {
            font-size: 1.1rem;
        }
        
        .btn-premium, .btn-gold {
            padding: 8px 16px;
            font-size: 0.8rem;
        }
        
        .logo {
            font-size: 1.3rem;
        }
    }
</style>
<script type="application/ld+json">
           {
               "@context": "https://schema.org",
               "@type": "ClothingStore",
               "name": "Trend Trove",
               "image": "https://i.postimg.cc/c1jC3WGV/1.png",
               "description": "Pakistan's premium online store for high-quality hoodies, track suits, and winter fashion.",
               "url": "https://trend-trove.pages.dev/",
               "telephone": "03205270810",
               "address": {
               "@type": "PostalAddress",
               "streetAddress": "Online Store",
               "addressLocality": "Faisalabad",
               "addressRegion": "Punjab",
               "postalCode": "38000",
               "addressCountry": "PK"
               },
               "geo": {
               "@type": "GeoCoordinates",
               "latitude": 31.4504,
               "longitude": 73.1350
               },
               "priceRange": "PKR 1000 - PKR 5000",
               "openingHoursSpecification": {
               "@type": "OpeningHoursSpecification",
               "dayOfWeek": [
                   "Monday",
                   "Tuesday",
                   "Wednesday",
                   "Thursday",
                   "Friday",
                   "Saturday",
                   "Sunday"
               ],
               "opens": "00:00",
               "closes": "23:59"
               },
               "sameAs": [
               "https://www.instagram.com/trendtrove", 
               "https://www.facebook.com/trendtrove"
               ]
           }
</script>
</head>
<body x-data="app()">
    <div class="transition-overlay active">
        <div class="shutter shutter-left">
            <div class="logo-container">
                <div class="split-logo">
                    <div class="logo-wrapper">
                        <img class="logo-image" src="https://i.postimg.cc/c1jC3WGV/1.png" alt="TrendTrove Logo Left">
                    </div>
                </div>
            </div>
        </div>
        <div class="shutter shutter-right">
            <div class="logo-container">
                <div class="split-logo">
                    <div class="logo-wrapper">
                        <img class="logo-image" src="https://i.postimg.cc/Vk4ddCs1/2.png" alt="TrendTrove Logo Right">
                    </div>
                </div>
            </div>
        </div>
        
        <div class="loader-container active">
            <div class="newtons-cradle">
                <div class="newtons-cradle__dot"></div>
                <div class="newtons-cradle__dot"></div>
                <div class="newtons-cradle__dot"></div>
                <div class="newtons-cradle__dot"></div>
            </div>
        </div>
    </div>
    <!-- Loading Bar -->
    <div class="loading-bar" id="loadingBar"></div>
    
    <!-- Cart Overlay -->
    <div class="cart-overlay" :class="{'active': cartOpen}" @click="cartOpen = false"></div>
    
    <!-- Cart Sidebar -->
    <div class="cart-sidebar" :class="{'active': cartOpen}">
        <div class="p-6">
            <div class="flex justify-between items-center mb-6">
                <h2 class="text-2xl font-bold">Your Cart</h2>
                <button @click="cartOpen = false" class="text-gray-500 hover:text-gray-700">
                    <i class="fas fa-times text-xl"></i>
                </button>
            </div>
            
            <div x-show="cartItems.length === 0" class="text-center py-12">
                <i class="fas fa-shopping-cart text-5xl text-gray-300 mb-4"></i>
                <p class="text-gray-500">Your cart is empty</p>
            </div>
            
            <div x-show="cartItems.length > 0">
                <div class="space-y-4 mb-6">
                    <template x-for="item in cartItems" :key="item.id">
                        <div class="flex items-center border-b pb-4">
                            <!-- CORRECTED LINE: Changed item.images[0] to item.frontImages[0] -->
                            <img :src="item.frontImages[0]" :alt="item.name" class="w-16 h-16 object-cover rounded">
                            <div class="ml-4 flex-1">
                                <h3 class="font-semibold" x-text="item.name"></h3>
                                <p class="text-sm text-gray-500" x-text="'Size: ' + item.size"></p>
                                <p class="text-sm text-gray-500" x-text="'Color: ' + item.color.name"></p>
                                <p class="text-gold font-bold" x-text="'PKR ' + (item.salePrice || item.price)"></p>
                            </div>
                            <button @click="removeFromCart(item.id)" class="text-red-500 hover:text-red-700">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    </template>
                </div>
                
                <div class="border-t pt-4 mb-6">
                    <div class="flex justify-between mb-2">
                        <span>Subtotal:</span>
                        <span x-text="'PKR ' + cartTotal"></span>
                    </div>
                    <div class="flex justify-between mb-2">
                        <span>Shipping:</span>
                        <span x-text="'PKR ' + shippingCost"></span>
                    </div>
                    <div class="flex justify-between font-bold text-lg">
                        <span>Total:</span>
                        <span x-text="'PKR ' + (cartTotal + shippingCost)"></span>
                    </div>
                </div>
                
                <button @click="proceedToCheckout()" class="btn-premium w-full py-3">Proceed to Checkout</button>
            </div>
        </div>
    </div>    
    <!-- Admin Panel (Visible when logged in as admin) -->
    <div x-show="isAdmin" class="admin-panel">
        <div class="container mx-auto px-6 flex justify-between items-center">
            <span class="text-gold font-semibold"><i class="fas fa-crown mr-2"></i>Admin Panel</span>
            <div>
                <button @click="showAdminDashboard()" class="bg-gold text-primary px-4 py-1 rounded-md font-medium hover:bg-yellow-600 transition-colors mr-4">Dashboard</button>
                <button @click="openAddProductModal()" class="bg-gold text-primary px-4 py-1 rounded-md font-medium hover:bg-yellow-600 transition-colors mr-4">Add Product</button>
                <button @click="openAddCategoryModal()" class="bg-gold text-primary px-4 py-1 rounded-md font-medium hover:bg-yellow-600 transition-colors mr-4">Manage Categories</button>
                <button @click="openAddSaleModal()" class="bg-gold text-primary px-4 py-1 rounded-md font-medium hover:bg-yellow-600 transition-colors mr-4">Add Sale</button>
                <button @click="openChangeCredentialsModal()" class="bg-gold text-primary px-4 py-1 rounded-md font-medium hover:bg-yellow-600 transition-colors mr-4">Change Credentials</button>
                <button @click="logout()" class="text-white hover:text-gold transition-colors">Logout</button>
            </div>
        </div>
    </div>
    
    <!-- Navigation -->
    <nav class="sticky-nav py-4" id="navbar" :class="isAdmin ? 'mt-10' : ''" style="margin-top: 0;">
        <div class="container mx-auto px-4 flex justify-between items-center">
            <a href="https://trend-trove.pages.dev" class="logo animate-pulse-slow flex items-center ml-0 hover:opacity-80 transition-opacity text-white">
                <span class="text-white">T</span>rend<span class="text-white">T</span>rove
            </a>
            
            <div class="hidden md:flex space-x-8">
                <a href="#" @click.prevent="showHomePage()" class="nav-link text-white hover-lift">Home</a>
                <a href="#" @click.prevent="showAllProductsPage()" class="nav-link text-white hover-lift">All Products</a>
                <a href="#" @click.prevent="showCollectionsPage()" class="nav-link text-white hover-lift">Collections</a>
                <template x-for="category in categories" :key="category.id">
                    <a href="#" @click.prevent="showCategoryPage(category.id)" class="nav-link text-white hover-lift" x-text="category.name"></a>
                </template>
                <a href="#" @click.prevent="showAboutPage()" class="nav-link text-white hover-lift">About</a>
                <a href="https://wa.me/message/TY5U3IM2LB6HJ1" class="nav-link text-white hover-lift">Contact</a>
            </div>
            
            <div class="flex items-center space-x-6">
                <button class="text-white hover:text-gold transition-colors hover-lift">
                    <i class="fas fa-search"></i>
                </button>
                
                <div class="relative" x-data="{ userDropdownOpen: false }">
                    <button class="text-white hover:text-gold transition-colors hover-lift" @click="userDropdownOpen = !userDropdownOpen">
                        <i class="fas fa-user"></i>
                    </button>
                    
                    <div x-show="userDropdownOpen" @click.outside="userDropdownOpen = false" class="absolute right-0 mt-2 w-48 bg-white rounded-md shadow-lg py-1 z-50">
                        <template x-if="!isLoggedIn">
                            <div>
                                <button @click="openLoginModal(); userDropdownOpen = false" class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 w-full text-left">
                                    <i class="fas fa-sign-in-alt mr-2"></i>Login
                                </button>
                                <button @click="openRegisterModal(); userDropdownOpen = false" class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 w-full text-left">
                                    <i class="fas fa-user-plus mr-2"></i>Register
                                </button>
                            </div>
                        </template>
                        <template x-if="isLoggedIn">
                            <div>
                                <div class="px-4 py-2 text-sm text-gray-700 border-b">
                                    <i class="fas fa-user-circle mr-2"></i>
                                    <span x-text="currentUser.name"></span>
                                </div>
                                <button @click="showUserProfile(); userDropdownOpen = false" class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 w-full text-left">
                                    <i class="fas fa-user mr-2"></i>My Profile
                                </button>
                                <button @click="showOrderHistory(); userDropdownOpen = false" class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 w-full text-left">
                                    <i class="fas fa-history mr-2"></i>Order History
                                </button>
                                <button @click="userLogout(); userDropdownOpen = false" class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 w-full text-left">
                                    <i class="fas fa-sign-out-alt mr-2"></i>Logout
                                </button>
                            </div>
                        </template>
                    </div>
                </div>
                
                <button class="text-white hover:text-gold transition-colors hover-lift relative" @click="cartOpen = true">
                    <i class="fas fa-shopping-bag"></i>
                    <span x-show="cartCount > 0" x-text="cartCount" class="absolute -top-2 -right-2 bg-gold text-primary text-xs rounded-full w-5 h-5 flex items-center justify-center"></span>
                </button>
                <button class="md:hidden text-white" @click="mobileMenuOpen = !mobileMenuOpen">
                    <i class="fas fa-bars"></i>
                </button>
            </div>
        </div>
    </nav>

    <!-- Page Containers -->
    <!-- Home Page -->
    <div x-show="currentPage === 'home'" class="page-container active">
        <!-- Hero Section -->
        <section class="hero-height relative flex items-center justify-center overflow-hidden" style="height: 100vh; margin-top: -80px; padding-top: 80px;">
            <!-- Desktop Image (hidden on mobile) -->
            <div class="absolute inset-0 z-0 hidden md:block">
                <img src="https://i.ibb.co/WNgpBQ9w/Untitled-574-x-328-px-4200-x-2400-px.png" alt="TrendTrove Premium Fashion" class="w-full h-full object-cover">
            </div>
            
            <!-- Mobile Image (hidden on desktop) -->
            <div class="absolute inset-0 z-0 md:hidden">
                <img src="https://i.ibb.co/h1L8LkyP/mobile.png" alt="TrendTrove Premium Fashion" class="w-full h-full object-cover">
            </div>
        </section>

        <!-- Products Section -->
        <section id="products" class="section-padding bg-cream">
            <div class="container mx-auto px-6">
                <div class="text-center mb-16 stagger-animation">
                    <h2 class="text-4xl md:text-5xl font-bold mb-4">New Arrivals</h2>
                    <p class="text-xl text-gray-600 max-w-2xl mx-auto">Discover our latest <strong>Winter Collection</strong>. From <strong>heavyweight fleece hoodies</strong> to <strong>luxury track suits</strong>, elevate your wardrobe with comfort.</p>
                </div>
                
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8 stagger-animation">
                    <!-- Product Cards -->
                    <template x-for="product in products.slice(0, 8)" :key="product.id">
                        <div class="product-card bg-white premium-shadow rounded-lg overflow-hidden hover-lift relative">
                            <div class="h-80 overflow-hidden relative">
                                <img :src="product.frontImages[0]" :alt="product.name" class="w-full h-full object-cover product-image">
                                
                                <template x-if="product.salePrice">
                                    <div class="absolute top-0 right-0 bg-red-600 text-white text-xs font-bold px-3 py-1 z-10" style="border-bottom-left-radius: 8px;">
                                        <span x-text="calculateDiscount(product) + '% OFF'"></span>
                                    </div>
                                </template>
                            </div>

                            <div class="p-6">
                                <h3 class="text-xl font-semibold mb-1" x-text="product.name"></h3>
                                <p class="text-gray-600 text-sm mb-3" x-text="product.description.substring(0, 60) + '...'"></p>
                                
                                <div class="flex justify-between items-end">
                                    <div>
                                        <template x-if="product.salePrice">
                                            <div class="flex flex-col">
                                                <span class="text-gray-400 text-sm line-through decoration-red-500" x-text="product.price"></span>
                                                <span class="text-2xl font-bold text-gray-900" x-text="product.salePrice"></span>
                                            </div>
                                        </template>
                                        <template x-if="!product.salePrice">
                                            <span class="text-2xl font-bold text-gray-900" x-text="product.price"></span>
                                        </template>
                                    </div>
                                    <button @click="showProductDetail(product)" class="btn-premium text-sm px-4 py-2">View Details</button>
                                </div>

                                <div class="mt-3 text-sm">
                                    <template x-if="product.stockStatus === 'out-of-stock'">
                                        <span class="text-red-500 font-medium">Out of Stock</span>
                                    </template>
                                    <template x-if="product.stockStatus === 'low-stock'">
                                        <span class="text-orange-500 font-medium">Low Stock</span>
                                    </template>
                                    <template x-if="product.stockStatus === 'in-stock'">
                                        <span class="text-green-500 font-medium">In Stock</span>
                                    </template>
                                </div>
                            </div>
                        </div>
                    </template>
                </div>
                
                <div class="text-center mt-12">
                    <button @click="showAllProductsPage()" class="btn-premium text-lg px-8 py-4 hover-lift premium-glow">VIEW ALL PRODUCTS</button>
                </div>
            </div>
        </section>
        
        <!-- Collections Section -->
        <section class="section-padding bg-highlight parallax-bg" id="collections" style="background-image: url('https://images.unsplash.com/photo-1556906781-2a4123b7c7a3?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=2070&q=80');">
            <div class="container mx-auto px-6 relative z-10">
                <div class="text-center mb-16 stagger-animation">
                    <h2 class="text-4xl md:text-5xl font-bold mb-4 text-black">Our Collections</h2>
                    <p class="text-xl text-black max-w-2xl mx-auto">Explore our curated collections of <strong>Hoodies</strong> and <strong>Sweet Shirts</strong> designed for every occasion.</p>
                </div>
                
                <div class="grid grid-cols-1 md:grid-cols-2 gap-8 stagger-animation">
                    <template x-for="category in categories.slice(0, 2)" :key="category.id">
                        <div class="collection-card rounded-lg overflow-hidden hover-lift">
                            <img :src="category.image" :alt="category.name" class="collection-image">
                            <div class="collection-overlay">
                                <h3 class="text-4xl font-bold mb-4" x-text="category.name + ' Collection'"></h3>
                                <p class="text-xl mb-6 max-w-md text-center" x-text="category.description"></p>
                                <button @click="showCategoryPage(category.id)" class="btn-premium">EXPLORE</button>
                            </div>
                        </div>
                    </template>
                </div>
            
                <div x-show="categories.length > 2" class="text-center mt-12">
                    <button @click="showAllCollectionsPage()" class="btn-premium text-lg px-8 py-4 hover-lift premium-glow">VIEW ALL COLLECTIONS</button>
                </div>
            </div>
        </section>        
        <!-- Testimonials -->
        <section class="section-padding bg-cream">
            <div class="container mx-auto px-6">
                <div class="text-center mb-16 stagger-animation">
                    <h2 class="text-4xl md:text-5xl font-bold mb-4">About Us</h2>
                </div>
                
                <div class="grid grid-cols-1 md:grid-cols-3 gap-8 stagger-animation">
                    <!-- Testimonial 1 -->
                    <div class="testimonial-card hover-lift">
                        <div class="flex items-center mb-4">
                            <div class="w-12 h-12 rounded-full overflow-hidden mr-4 morph-shape">
                                <img src="https://i.postimg.cc/NfDb16hT/Screenshot-2025-10-27-214550.png" alt="Sarah Johnson" class="w-full h-full object-cover">
                            </div>
                            <div>
                                <h2 class="font-semibold">Mian Muhammad Farooq Azam</h2>
                                <h5 class="font-bold">Founder</h5>
                            </div>
                        </div>
                        <p class="text-gray-600">"Assalam-o-Alaikum. My name is Mian Muhammad Farooq Azam, and I am the proud founder of this company. With a deep passion for quality, creativity, and customer satisfaction, I established this brand to bring innovation and elegance to the clothing industry. My goal is to create a company that not only provides premium apparel but also builds trust and long-term relationships with our customers."</p>
                    </div>
                    
                    <!-- Testimonial 2 -->
                    <div class="testimonial-card hover-lift">
                        <div class="flex items-center mb-4">
                            <div class="w-12 h-12 rounded-full overflow-hidden mr-4 morph-shape">
                                <img src="https://i.postimg.cc/5yxL0r27/Screenshot-2025-10-27-215542.png" alt="Michael Chen" class="w-full h-full object-cover">
                            </div>
                            <div>
                                <h2 class="font-semibold">Ahmad Farooq</h2>
                                <h5 class="font-bold">Co-Founder</h5>
                            </div>
                        </div>
                        <p class="text-gray-600">"Assalam-o-Alaikum. My name is Ahmad Farooq, and I am currently pursuing my Bachelorâ€™s degree in Artificial Intelligence at FAST-NU. As the Co-Founder, I am working alongside my father to expand and modernize our company. My focus is on integrating technology, design innovation, and digital growth strategies to help our brand reach new heights and connect with a global audience"</p>
                    </div>
                </div>
            </div>
        </section>
    </div>
    
    <!-- All Products Page -->
    <div x-show="currentPage === 'all-products'" class="page-container">
        <div class="min-h-screen bg-cream py-8">
            <div class="container mx-auto px-4">
                <div class="flex justify-between items-center mb-8">
                    <h1 class="text-4xl font-bold">All Products</h1>
                    <button @click="showHomePage()" class="flex items-center text-primary hover:text-gold transition-colors hover-lift">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18" />
                        </svg>
                        Back to Home
                    </button>
                </div>
                
                <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-8">
                    <template x-for="product in products" :key="product.id">
                        <div class="product-card bg-white premium-shadow rounded-lg overflow-hidden hover-lift">
                            <div class="h-80 overflow-hidden">
                                <img :src="product.frontImages[0]" :alt="product.name" class="w-full h-full object-cover product-image">
                            </div>
                            <div class="p-6">
                                <h3 class="text-xl font-semibold mb-1" x-text="product.name"></h3>
                                <p class="text-gray-600 text-sm mb-3" x-text="product.description.substring(0, 60) + '...'"></p>
                                <div class="flex justify-between items-center">
                                    <div>
                                        <template x-if="product.salePrice">
                                            <div class="flex items-center">
                                                <span class="text-2xl font-bold text-gold" x-text="'PKR ' + product.salePrice"></span>
                                                <span class="original-price ml-2" x-text="'PKR ' + product.price"></span>
                                                <span class="discount-badge" x-text="calculateDiscount(product) + '% OFF'"></span>
                                            </div>
                                        </template>
                                        <template x-if="!product.salePrice">
                                            <span class="text-2xl font-bold text-gold" x-text="'PKR ' + product.price"></span>
                                        </template>
                                    </div>
                                    <button @click="showProductDetail(product)" class="btn-premium">View Details</button>
                                </div>
                                <div class="mt-3 text-sm">
                                    <template x-if="product.stockStatus === 'out-of-stock'">
                                        <span class="text-red-500 font-medium">Out of Stock</span>
                                    </template>
                                    <template x-if="product.stockStatus === 'low-stock'">
                                        <span class="text-orange-500 font-medium">Low Stock</span>
                                    </template>
                                    <template x-if="product.stockStatus === 'in-stock'">
                                        <span class="text-green-500 font-medium">In Stock</span>
                                    </template>
                                </div>
                            </div>
                        </div>
                    </template>
                </div>
            </div>
        </div>
    </div>
    <div x-show="currentPage === 'all-collections'" class="page-container">
    Â  Â  <div class="min-h-screen bg-cream py-8">
    Â  Â  Â  Â  <div class="container mx-auto px-4">
    Â  Â  Â  Â  Â  Â  <div class="flex justify-between items-center mb-8">
    Â  Â  Â  Â  Â  Â  Â  Â  <h1 class="text-4xl font-bold">All Collections</h1>
    Â  Â  Â  Â  Â  Â  Â  Â  <button @click="showHomePage()" class="flex items-center text-primary hover:text-gold transition-colors hover-lift">
    Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
    Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18" />
    Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </svg>
    Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Back to Home
    Â  Â  Â  Â  Â  Â  Â  Â  </button>
    Â  Â  Â  Â  Â  Â  </div>
    Â  Â  Â  Â  Â  Â Â 
    Â  Â  Â  Â  Â  Â  <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                    <template x-for="category in categories" :key="category.id">
                        <div class="collection-card rounded-lg overflow-hidden hover-lift" style="height: 400px;">
                            <img :src="category.image" :alt="category.name" class="collection-image">
                            
                            <div class="collection-overlay">
                                <h3 class="text-3xl font-bold mb-4" x-text="category.name"></h3>
                                <p class="text-lg mb-6 max-w-md text-center" x-text="category.description"></p>
                                <button @click="showCategoryPage(category.id)" class="btn-premium">EXPLORE</button>
                            </div> </div>
                    </template>
    Â  Â  Â  Â  Â  Â  </div>
    Â  Â  Â  Â  </div>
    Â  Â  </div>
    </div>
    <!-- Category Products Page -->
    <div x-show="currentPage === 'category-products'" class="page-container">
        <div class="min-h-screen bg-cream py-8">
            <div class="container mx-auto px-4">
                <div class="flex justify-between items-center mb-8">
                    <h1 class="text-4xl font-bold" x-text="selectedCategory.name"></h1>
                    <button @click="showHomePage()" class="flex items-center text-primary hover:text-gold transition-colors hover-lift">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18" />
                        </svg>
                        Back to Home
                    </button>
                </div>
                
                <div class="mb-8">
                    <p class="text-xl text-gray-600" x-text="selectedCategory.description"></p>
                </div>
                
                <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-8">
                    <template x-for="product in categoryProducts" :key="product.id">
                        <div class="product-card bg-white premium-shadow rounded-lg overflow-hidden hover-lift">
                            <div class="h-80 overflow-hidden">
                                <img :src="product.frontImages[0]" :alt="product.name" class="w-full h-full object-cover product-image">
                            </div>
                            <div class="p-6">
                                <h3 class="text-xl font-semibold mb-1" x-text="product.name"></h3>
                                <p class="text-gray-600 text-sm mb-3" x-text="product.description.substring(0, 60) + '...'"></p>
                                <div class="flex justify-between items-center">
                                    <div>
                                        <template x-if="product.salePrice">
                                            <div class="flex items-center">
                                                <span class="text-2xl font-bold text-gold" x-text="'PKR ' + product.salePrice"></span>
                                                <span class="original-price ml-2" x-text="'PKR ' + product.price"></span>
                                                <span class="discount-badge" x-text="calculateDiscount(product) + '% OFF'"></span>
                                            </div>
                                        </template>
                                        <template x-if="!product.salePrice">
                                            <span class="text-2xl font-bold text-gold" x-text="'PKR ' + product.price"></span>
                                        </template>
                                    </div>
                                    <button @click="showProductDetail(product)" class="btn-premium">View Details</button>
                                </div>
                                <div class="mt-3 text-sm">
                                    <template x-if="product.stockStatus === 'out-of-stock'">
                                        <span class="text-red-500 font-medium">Out of Stock</span>
                                    </template>
                                    <template x-if="product.stockStatus === 'low-stock'">
                                        <span class="text-orange-500 font-medium">Low Stock</span>
                                    </template>
                                    <template x-if="product.stockStatus === 'in-stock'">
                                        <span class="text-green-500 font-medium">In Stock</span>
                                    </template>
                                </div>
                            </div>
                        </div>
                    </template>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Product Detail Page -->
    <div x-show="currentPage === 'product-detail'" class="page-container">
        <div class="min-h-screen bg-cream py-8">
            <div class="container mx-auto px-4">
                <button @click="showPreviousPage()" class="mb-6 flex items-center text-primary hover:text-gold transition-colors hover-lift">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18" />
                    </svg>
                    Back to Products
                </button>
                
                <div class="bg-white rounded-lg shadow-lg overflow-hidden">
                    <div class="flex flex-col md:flex-row">
                        <div class="md:w-1/2 p-6">
                            <div class="mb-4 h-auto md:h-96 overflow-hidden rounded-lg bg-gray-50">
                                <img 
                                    :src="selectedProduct.detailImages ? selectedProduct.detailImages[selectedImageIndex] : ''" 
                                    :alt="selectedProduct.name" 
                                    class="w-full h-auto md:h-full md:object-cover"
                                >
                            </div>
                            <div class="flex space-x-2 overflow-x-auto pb-2">
                                <template x-if="selectedProduct.detailImages">
                                    <template x-for="(image, index) in selectedProduct.detailImages" :key="index">
                                        <button @click="selectedImageIndex = index" class="flex-shrink-0 w-20 h-20 border-2 rounded hover-lift" :class="selectedImageIndex === index ? 'border-gold premium-glow' : 'border-gray-200'">
                                            <img :src="image" :alt="selectedProduct.name" class="w-full h-full object-cover">
                                        </button>
                                    </template>
                                </template>
                            </div>
                        </div>
                        
                        <div class="md:w-1/2 p-6 bg-highlight">
                            <h1 class="text-3xl font-bold mb-2" x-text="selectedProduct.name"></h1>
                            <p class="text-gray-600 mb-4" x-text="selectedProduct.description"></p>
                            
                            <div class="mb-6">
                                <template x-if="selectedProduct.salePrice">
                                    <div class="flex flex-col items-start">
                                        <span class="text-gray-500 text-lg line-through decoration-red-500 decoration-2 mb-1" x-text="selectedProduct.price"></span>
                                        
                                        <div class="flex items-center gap-3">
                                            <span class="text-4xl font-bold text-gray-900" x-text="selectedProduct.salePrice"></span>
                                            
                                            <span class="bg-red-600 text-white px-3 py-1 rounded-full text-sm font-bold shadow-sm" x-text="calculateDiscount(selectedProduct) + '% OFF'"></span>
                                        </div>
                                    </div>
                                </template>
                                <template x-if="!selectedProduct.salePrice">
                                    <span class="text-4xl font-bold text-gray-900" x-text="selectedProduct.price"></span>
                                </template>
                            </div>
                            
                            <div class="mb-6">
                                <h3 class="font-bold mb-2">Select Color</h3>
                                <div class="flex flex-wrap gap-2 mb-4">
                                    <template x-for="color in selectedProduct.colors" :key="color.code">
                                        <button 
                                            @click="selectColor(color)" 
                                            class="w-10 h-10 rounded-full border-2 focus:outline-none transition-transform hover:scale-110"
                                            :style="`background-color: ${color.code}`"
                                            :class="selectedColor && selectedColor.code === color.code ? 'border-black scale-110 ring-2 ring-offset-2 ring-gray-400' : 'border-gray-300'"
                                            :title="color.name"
                                        ></button>
                                    </template>
                                </div>
                                <p class="text-sm text-gray-600" x-text="selectedColor ? 'Selected Color: ' + selectedColor.name : 'Please select a color'"></p>
                            </div>
                            
                            <div class="mb-6">
                                <h3 class="font-bold mb-2">Select Size</h3>
                                <div class="flex flex-wrap gap-2">
                                    <template x-for="size in selectedProduct.sizes" :key="size">
                                        <button 
                                            @click="selectSize(size)" 
                                            class="size-option"
                                            :class="{
                                                'active': selectedSize === size,
                                                'opacity-50 cursor-not-allowed bg-gray-200': selectedColor && getStockForColorAndSize(selectedColor.code, size) == 0
                                            }"
                                            x-text="size"
                                        ></button>
                                    </template>
                                </div>
                                <p x-show="selectedColor && selectedSize && getStockForColorAndSize(selectedColor.code, selectedSize) == 0" class="text-red-500 text-sm mt-1">Out of Stock</p>
                            </div>
                            
                            <div class="flex space-x-4">
                                <button 
                                    @click="addToCart(selectedProduct)" 
                                    class="flex-1 bg-gray-800 text-white py-3 rounded-md font-medium transition-colors hover:bg-black hover-lift"
                                >
                                    Add to Cart
                                </button>
                                <button 
                                    @click="buyNow(selectedProduct)" 
                                    class="flex-1 btn-gold py-3 rounded-md font-medium shadow-md hover-lift premium-glow"
                                >
                                    Buy Now
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <div class="p-6 border-t border-gray-200 bg-gray-50">
                        <h3 class="text-2xl font-bold mb-6">Customer Reviews</h3>

                        <div x-show="userCanReview" class="bg-white p-6 rounded-lg shadow-md mb-8 border border-gold">
                            <h4 class="font-bold text-lg mb-3">Write a Review</h4>
                            <p class="text-sm text-green-600 mb-4"><i class="fas fa-check-circle"></i> Verified Purchase</p>
                            
                            <form @submit.prevent="submitReview()">
                                <div class="flex items-center mb-4">
                                    <label class="mr-4 text-gray-700">Rating:</label>
                                    <div class="flex space-x-1 cursor-pointer">
                                        <template x-for="i in 5">
                                            <i class="fas fa-star text-2xl transition-colors hover:scale-110" 
                                               :class="i <= newReview.rating ? 'text-yellow-400' : 'text-gray-300'"
                                               @click="newReview.rating = i"></i>
                                        </template>
                                    </div>
                                </div>

                                <div class="mb-4">
                                    <textarea x-model="newReview.comment" class="w-full p-3 border border-gray-300 rounded focus:border-gold focus:outline-none" rows="3" placeholder="How was the product?"></textarea>
                                </div>

                                <button type="submit" class="btn-premium py-2 px-6 rounded text-sm">Submit Review</button>
                            </form>
                        </div>

                        <div x-show="!userCanReview && isLoggedIn" class="mb-8 p-4 bg-blue-50 text-blue-700 rounded-lg">
                            <p>You must purchase this item to leave a review.</p>
                        </div>
                        <div x-show="!isLoggedIn" class="mb-8 p-4 bg-gray-100 text-gray-700 rounded-lg">
                            <p>Please login to leave a review.</p>
                        </div>

                        <div class="space-y-4">
                            <template x-show="productReviews.length === 0">
                                <div class="text-gray-500 italic text-center py-4">
                                    No reviews yet. Be the first to review this product!
                                </div>
                            </template>

                            <template x-for="review in productReviews" :key="review.date + review.userName">
                                <div class="bg-white p-4 rounded-lg shadow-sm border border-gray-100">
                                    <div class="flex justify-between items-start mb-2">
                                        <div>
                                            <p class="font-bold text-gray-800" x-text="review.userName"></p>
                                            <div class="flex text-yellow-400 text-xs mt-1">
                                                <template x-for="i in 5">
                                                    <i class="fas fa-star" :class="i <= review.rating ? '' : 'text-gray-300'"></i>
                                                </template>
                                            </div>
                                        </div>
                                        <span class="text-xs text-gray-500" x-text="review.date"></span>
                                    </div>
                                    <p class="text-gray-600 text-sm" x-text="review.comment"></p>
                                </div>
                            </template>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>    

    <!-- Admin Dashboard -->
    <div x-show="currentPage === 'admin-dashboard'" class="page-container">
        <div class="admin-dashboard">
            <div class="container mx-auto px-4">
                <div class="flex justify-between items-center mb-8">
                    <h1 class="text-4xl font-bold">Admin Dashboard</h1>
                    <button @click="showHomePage()" class="flex items-center text-primary hover:text-gold transition-colors hover-lift">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18" />
                        </svg>
                        Back to Home
                    </button>
                </div>

                <!-- Category Management Section -->
                <div class="bg-white rounded-lg shadow-lg overflow-hidden mb-8">
                    <div class="p-6 border-b flex justify-between items-center">
                        <div>
                            <h2 class="text-2xl font-bold">Category Management</h2>
                            <p class="text-gray-600 mt-2">Manage product categories</p>
                        </div>
                        <div>
                            <button @click="openAddCategoryModal()" class="btn-premium mr-4">Add New Category</button>
                            <button @click="openRemoveCategoryModal()" class="btn-gold">Remove Category</button>
                        </div>
                    </div>
                    
                    <div class="overflow-x-auto">
                        <table class="admin-table">
                            <thead>
                                <tr>
                                    <th>Image</th>
                                    <th>Category Name</th>
                                    <th>Description</th>
                                    <th>Products</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody>
                                <template x-for="category in categories" :key="category.id">
                                    <tr>
                                        <td>
                                            <img :src="category.image" :alt="category.name" class="w-16 h-16 object-cover rounded">
                                        </td>
                                        <td>
                                            <span class="font-semibold" x-text="category.name"></span>
                                        </td>
                                        <td>
                                            <span class="text-gray-600" x-text="category.description"></span>
                                        </td>
                                        <td>
                                            <span class="text-gold font-bold" x-text="getProductCountByCategory(category.id)"></span>
                                        </td>
                                        <td>
                                            <div class="flex space-x-2">
                                                <button @click="editCategory(category)" class="text-blue-500 hover:text-blue-700">
                                                    <i class="fas fa-edit"></i>
                                                </button>
                                                <button @click="deleteCategory(category.id)" class="text-red-500 hover:text-red-700" :disabled="getProductCountByCategory(category.id) > 0">
                                                    <i class="fas fa-trash"></i>
                                                </button>
                                            </div>
                                        </td>
                                    </tr>
                                </template>
                            </tbody>
                        </table>
                    </div>
                </div>            
                
                <div class="bg-white rounded-lg shadow-lg overflow-hidden mb-8">
                    <div class="p-6 border-b">
                        <h2 class="text-2xl font-bold">Product Management</h2>
                        <p class="text-gray-600 mt-2">Manage all products in your inventory</p>
                    </div>
                    
                    <div class="overflow-x-auto">
                        <table class="admin-table">
                            <thead>
                                <tr>
                                    <th>Image</th>
                                    <th>Product Name</th>
                                    <th>Seller</th>
                                    <th>Colors & Stock</th>
                                    <th>Price</th>
                                    <th>Sale Price</th>
                                    <th>Status</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody>
                                <template x-for="product in products" :key="product.id">
                                    <tr>
                                        <td>
                                            <img :src="product.frontImages[0]" :alt="product.name" class="w-16 h-16 object-cover rounded">
                                        </td>
                                        <td>
                                            <span class="font-semibold" x-text="product.name"></span>
                                            <template x-if="product.salePrice">
                                                <span class="discount-badge ml-2" x-text="calculateDiscount(product) + '% OFF'"></span>
                                            </template>
                                        </td>
                                        <td x-text="product.seller"></td>
                                        <td>
                                            <div class="flex flex-wrap gap-1">
                                                <template x-for="color in product.colors" :key="color.code">
                                                    <div class="flex items-center mb-1">
                                                        <div class="w-4 h-4 rounded-full mr-1" :style="`background-color: ${color.code}`"></div>
                                                        <span class="text-xs mr-2" x-text="color.name"></span>
                                                        <template x-for="size in product.sizes" :key="size.name">
                                                            <span class="stock-badge text-xs" 
                                                                  :class="{
                                                                      'stock-out': color.stock[size.name] === 0,
                                                                      'stock-low': color.stock[size.name] > 0 && color.stock[size.name] <= 5,
                                                                      'stock-medium': color.stock[size.name] > 5 && color.stock[size.name] <= 15,
                                                                      'stock-high': color.stock[size.name] > 15
                                                                  }"
                                                                  x-text="size.name + ': ' + color.stock[size.name]">
                                                            </span>
                                                        </template>
                                                    </div>
                                                </template>
                                            </div>
                                        </td>
                                        <td>
                                            <template x-if="product.salePrice">
                                                <span class="original-price" x-text="'PKR ' + product.price"></span>
                                            </template>
                                            <template x-if="!product.salePrice">
                                                <span class="text-gold font-bold" x-text="'PKR ' + product.price"></span>
                                            </template>
                                        </td>
                                        <td>
                                            <template x-if="product.salePrice">
                                                <span class="sale-price" x-text="'PKR ' + product.salePrice"></span>
                                            </template>
                                            <template x-if="!product.salePrice">
                                                <span class="text-gray-400">-</span>
                                            </template>
                                        </td>
                                        <td>
                                            <span class="stock-badge" 
                                                  :class="{
                                                      'stock-out': product.stockStatus === 'out-of-stock',
                                                      'stock-low': product.stockStatus === 'low-stock',
                                                      'stock-high': product.stockStatus === 'in-stock'
                                                  }"
                                                  x-text="product.stockStatus === 'out-of-stock' ? 'Out of Stock' : product.stockStatus === 'low-stock' ? 'Low Stock' : 'In Stock'">
                                            </span>
                                        </td>
                                        <td>
                                            <div class="flex space-x-2">
                                                <button @click="editProduct(product)" class="text-blue-500 hover:text-blue-700">
                                                    <i class="fas fa-edit"></i>
                                                </button>
                                                <button @click="deleteProduct(product.id)" class="text-red-500 hover:text-red-700">
                                                    <i class="fas fa-trash"></i>
                                                </button>
                                            </div>
                                        </td>
                                    </tr>
                                </template>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- User Profile Page -->
    <div x-show="currentPage === 'user-profile'" class="page-container">
        <div class="min-h-screen bg-cream py-8">
            <div class="container mx-auto px-4">
                <div class="flex justify-between items-center mb-8">
                    <h1 class="text-4xl font-bold">My Profile</h1>
                    <button @click="showHomePage()" class="flex items-center text-primary hover:text-gold transition-colors hover-lift">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18" />
                        </svg>
                        Back to Home
                    </button>
                </div>
                
                <div class="bg-white rounded-lg shadow-lg overflow-hidden">
                    <div class="p-6 border-b">
                        <h2 class="text-2xl font-bold">Personal Information</h2>
                        <p class="text-gray-600 mt-2">Manage your personal details and preferences</p>
                    </div>
                    
                    <div class="p-6">
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div>
                                <h3 class="font-bold mb-4 text-lg">Account Details</h3>
                                <div class="space-y-4">
                                    <div>
                                        <label class="block text-gray-700 mb-2">Full Name</label>
                                        <p class="text-gray-900 font-medium" x-text="currentUser.name"></p>
                                    </div>
                                    <div>
                                        <label class="block text-gray-700 mb-2">Email Address</label>
                                        <p class="text-gray-900 font-medium" x-text="currentUser.email"></p>
                                    </div>
                                    <div>
                                        <label class="block text-gray-700 mb-2">Phone Number</label>
                                        <p class="text-gray-900 font-medium" x-text="currentUser.phone || 'Not provided'"></p>
                                    </div>
                                    <div>
                                        <label class="block text-gray-700 mb-2">Member Since</label>
                                        <p class="text-gray-900 font-medium" x-text="new Date(currentUser.createdAt).toLocaleDateString()"></p>
                                    </div>
                                </div>
                            </div>
                            
                            <div>
                                <h3 class="font-bold mb-4 text-lg">Quick Stats</h3>
                                <div class="space-y-4">
                                    <div class="bg-highlight p-4 rounded-lg">
                                        <div class="flex items-center">
                                            <div class="bg-gold text-primary rounded-full p-3 mr-4">
                                                <i class="fas fa-shopping-bag"></i>
                                            </div>
                                            <div>
                                                <p class="text-gray-600">Total Orders</p>
                                                <p class="text-2xl font-bold" x-text="userOrders.length"></p>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div class="bg-highlight p-4 rounded-lg">
                                        <div class="flex items-center">
                                            <div class="bg-gold text-primary rounded-full p-3 mr-4">
                                                <i class="fas fa-heart"></i>
                                            </div>
                                            <div>
                                                <p class="text-gray-600">Wishlist Items</p>
                                                <p class="text-2xl font-bold" x-text="userWishlist.length"></p>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="mt-8">
                            <h3 class="font-bold mb-4 text-lg">Recent Orders</h3>
                            <div class="bg-gray-50 p-4 rounded-lg">
                                <template x-if="userOrders.length === 0">
                                    <p class="text-gray-600 text-center py-4">You haven't placed any orders yet.</p>
                                </template>
                                <template x-if="userOrders.length > 0">
                                    <div class="space-y-4">
                                        <template x-for="order in userOrders.slice(0, 3)" :key="order.id">
                                            <div class="border-b pb-4 last:border-b-0">
                                                <div class="flex justify-between items-center">
                                                    <div>
                                                        <p class="font-medium" x-text="'Order #' + order.id"></p>
                                                        <p class="text-sm text-gray-600" x-text="new Date(order.date).toLocaleDateString()"></p>
                                                    </div>
                                                    <div class="text-right">
                                                        <p class="font-bold text-gold" x-text="'PKR ' + order.total"></p>
                                                        <p class="text-sm" :class="{'text-green-600': order.status === 'delivered', 'text-yellow-600': order.status === 'processing', 'text-blue-600': order.status === 'shipped'}" x-text="order.status.charAt(0).toUpperCase() + order.status.slice(1)"></p>
                                                    </div>
                                                </div>
                                            </div>
                                        </template>
                                    </div>
                                </template>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Order History Page -->
    <div x-show="currentPage === 'order-history'" class="page-container">
        <div class="min-h-screen bg-cream py-8">
            <div class="container mx-auto px-4">
                <div class="flex justify-between items-center mb-8">
                    <h1 class="text-4xl font-bold">Order History</h1>
                    <button @click="showHomePage()" class="flex items-center text-primary hover:text-gold transition-colors hover-lift">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18" />
                        </svg>
                        Back to Home
                    </button>
                </div>
                
                <div class="bg-white rounded-lg shadow-lg overflow-hidden">
                    <div class="p-6 border-b">
                        <h2 class="text-2xl font-bold">Your Orders</h2>
                        <p class="text-gray-600 mt-2">View your order history and track current orders</p>
                    </div>
                    
                    <div class="p-6">
                        <template x-if="userOrders.length === 0">
                            <div class="text-center py-12">
                                <i class="fas fa-shopping-bag text-5xl text-gray-300 mb-4"></i>
                                <p class="text-gray-500 text-xl mb-4">You haven't placed any orders yet</p>
                                <button @click="showAllProductsPage()" class="btn-premium">Start Shopping</button>
                            </div>
                        </template>
                        
                        <template x-if="userOrders.length > 0">
                            <div class="space-y-6">
                                <template x-for="order in userOrders" :key="order.id">
                                    <div class="border rounded-lg p-6 hover-lift">
                                        <div class="flex justify-between items-start mb-4">
                                            <div>
                                                <h3 class="font-bold text-lg" x-text="'Order #' + order.id"></h3>
                                                <p class="text-gray-600" x-text="'Placed on ' + new Date(order.date).toLocaleDateString()"></p>
                                            </div>
                                            <div class="text-right">
                                                <p class="font-bold text-gold text-xl" x-text="'PKR ' + order.total"></p>
                                                <span class="px-3 py-1 rounded-full text-sm font-medium" 
                                                      :class="{
                                                          'bg-green-100 text-green-800': order.status === 'delivered',
                                                          'bg-yellow-100 text-yellow-800': order.status === 'processing',
                                                          'bg-blue-100 text-blue-800': order.status === 'shipped'
                                                      }"
                                                      x-text="order.status.charAt(0).toUpperCase() + order.status.slice(1)">
                                                </span>
                                            </div>
                                        </div>
                                        
                                        <div class="border-t pt-4">
                                            <h4 class="font-medium mb-2">Items:</h4>
                                            <div class="space-y-2">
                                                <template x-for="item in order.items" :key="item.id">
                                                    <div class="flex items-center">
                                                        <img :src="item.image" :alt="item.name" class="w-12 h-12 object-cover rounded mr-3">
                                                        <div class="flex-1">
                                                            <p class="font-medium" x-text="item.name"></p>
                                                            <p class="text-sm text-gray-600" x-text="'Size: ' + item.size + ' | Color: ' + item.color"></p>
                                                        </div>
                                                        <p class="text-gold font-bold" x-text="'PKR ' + item.price"></p>
                                                    </div>
                                                </template>
                                            </div>
                                        </div>
                                    </div>
                                </template>
                            </div>
                        </template>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Payment Page -->
    <div x-show="currentPage === 'payment'" class="page-container">
        <div class="min-h-screen bg-cream py-8">
            <div class="container mx-auto px-4">
                <button @click="showHomePage()" class="mb-6 flex items-center text-primary hover:text-gold transition-colors hover-lift">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18" />
                    </svg>
                    Back to Home
                </button>
                
                <div class="bg-white rounded-lg shadow-lg overflow-hidden">
                    <div class="p-6 border-b">
                        <h1 class="text-3xl font-bold">Complete Your Order</h1>
                        <p class="text-gray-600 mt-2">Review your order details and select a payment method</p>
                    </div>
                    
                    <div class="grid grid-cols-1 lg:grid-cols-3 gap-8 p-6">
                        <!-- Order Summary -->
                        <div class="lg:col-span-2">
                            <h2 class="text-2xl font-bold mb-4">Order Summary</h2>
                            
                            <div class="bg-gray-50 p-6 rounded-lg mb-6 hover-lift">
                                <div class="flex justify-between mb-4 pb-4 border-b">
                                    <div>
                                        <h3 class="font-bold text-lg" x-text="selectedProduct.name"></h3>
                                        <p class="text-gray-600" x-text="'Size: ' + selectedSize"></p>
                                        <p class="text-gray-600" x-text="'Color: ' + selectedColor.name"></p>
                                    </div>
                                    <span class="text-xl font-bold text-gold" x-text="'PKR ' + (selectedProduct.salePrice || selectedProduct.price)"></span>
                                </div>
                                
                                <div class="space-y-2">
                                    <div class="flex justify-between">
                                        <span>Subtotal:</span>
                                        <span x-text="'PKR ' + (selectedProduct.salePrice || selectedProduct.price)"></span>
                                    </div>
                                    <div class="flex justify-between">
                                        <span>Shipping:</span>
                                        <span x-text="'PKR ' + shippingCost"></span>
                                    </div>
                                    <div class="flex justify-between font-bold text-lg pt-2 border-t">
                                        <span>Total:</span>
                                        <span x-text="'PKR ' + ((selectedProduct.salePrice || selectedProduct.price) + shippingCost)"></span>
                                    </div>
                                </div>
                            </div>
                            
                            <div>
                                <h2 class="text-2xl font-bold mb-4">Shipping Information</h2>
                                <form @submit.prevent="placeOrder()">
                                    <div class="bg-gray-50 p-6 rounded-lg hover-lift">
                                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                                            <div>
                                                <label class="block text-gray-700 mb-2" for="fullName">Full Name</label>
                                                <input type="text" id="fullName" x-model="checkoutForm.fullName" class="w-full px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:border-gold" required>
                                            </div>
                                            <div>
                                                <label class="block text-gray-700 mb-2" for="email">Email</label>
                                                <input type="email" id="email" x-model="checkoutForm.email" class="w-full px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:border-gold" required>
                                            </div>
                                            <div>
                                                <label class="block text-gray-700 mb-2" for="phone">Phone</label>
                                                <input type="tel" id="phone" x-model="checkoutForm.phone" class="w-full px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:border-gold" required>
                                            </div>
                                            <div>
                                                <label class="block text-gray-700 mb-2" for="province">Province</label>
                                                <input type="text" id="province" x-model="checkoutForm.province" class="w-full px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:border-gold" required>
                                            </div>
                                            <div>
                                                <label class="block text-gray-700 mb-2" for="district">District</label>
                                                <input type="text" id="district" x-model="checkoutForm.district" class="w-full px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:border-gold" required>
                                            </div>
                                            <div>
                                                <label class="block text-gray-700 mb-2" for="city">City</label>
                                                <input type="text" id="city" x-model="checkoutForm.city" class="w-full px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:border-gold" required>
                                            </div>
                                        </div>
                                        <div class="mb-4">
                                            <label class="block text-gray-700 mb-2" for="address">Address</label>
                                            <textarea id="address" x-model="checkoutForm.address" class="w-full px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:border-gold" rows="3" required></textarea>
                                        </div>
                                    </div>
                                </form>
                            </div>
                        </div>
                        
                        <!-- Payment Method -->
                        <div>
                            <h2 class="text-2xl font-bold mb-4">Payment Method</h2>
                            
                            <div class="bg-gray-50 p-6 rounded-lg">
                                <div class="space-y-4 mb-6">
                                    <div class="flex items-center p-4 border rounded-lg cursor-pointer hover:border-gold transition-colors hover-lift" :class="paymentMethod === 'card' ? 'border-gold bg-gold bg-opacity-10 premium-glow' : 'border-gray-300'" @click="paymentMethod = 'card'">
                                        <input type="radio" id="card" name="payment" value="card" x-model="paymentMethod" class="mr-3">
                                        <label for="card" class="flex items-center cursor-pointer">
                                            <i class="fas fa-credit-card mr-2 text-gray-600"></i>
                                            Pay by Card
                                        </label>
                                    </div>
                                    
                                    <div class="flex items-center p-4 border rounded-lg cursor-pointer hover:border-gold transition-colors hover-lift" :class="paymentMethod === 'mobile' ? 'border-gold bg-gold bg-opacity-10 premium-glow' : 'border-gray-300'" @click="paymentMethod = 'mobile'">
                                        <input type="radio" id="mobile" name="payment" value="mobile" x-model="paymentMethod" class="mr-3">
                                        <label for="mobile" class="flex items-center cursor-pointer">
                                            <i class="fas fa-mobile-alt mr-2 text-gray-600"></i>
                                            Pay via JazzCash / EasyPaisa
                                        </label>
                                    </div>
                                    
                                    <div class="flex items-center p-4 border rounded-lg cursor-pointer hover:border-gold transition-colors hover-lift" :class="paymentMethod === 'cod' ? 'border-gold bg-gold bg-opacity-10 premium-glow' : 'border-gray-300'" @click="paymentMethod = 'cod'">
                                        <input type="radio" id="cod" name="payment" value="cod" x-model="paymentMethod" class="mr-3">
                                        <label for="cod" class="flex items-center cursor-pointer">
                                            <i class="fas fa-money-bill-wave mr-2 text-gray-600"></i>
                                            Cash on Delivery
                                        </label>
                                    </div>
                                </div>
                                
                                <button @click="placeOrder()" class="w-full btn-premium py-3 rounded-md font-medium shadow-md hover-lift premium-glow">Confirm Order</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Order Confirmation Page -->
    <div x-show="currentPage === 'order-confirmation'" class="page-container">
        <div class="min-h-screen bg-cream py-8">
            <div class="container mx-auto px-4">
                <div class="bg-white rounded-lg shadow-lg overflow-hidden max-w-4xl mx-auto">
                    <div class="text-center p-8 bg-green-50">
                        <div class="w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4 animate-pulse-slow">
                            <i class="fas fa-check text-green-600 text-2xl"></i>
                        </div>
                        <h2 class="text-2xl font-bold mb-2">Order Confirmed!</h2>
                        <p class="text-gray-600">
                            Thank you for choosing TrendTrove!<br>
                            Your order has been confirmed and will reach you soon
                        </p>
                    </div>
                    
                    <div class="p-8">
                        <h3 class="font-bold mb-6 text-2xl text-center">Order Details</h3>
                        
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-8 mb-8">
                            <div>
                                <h4 class="font-medium mb-4 text-lg border-b pb-2">Shipping Information</h4>
                                <p x-text="checkoutForm.fullName"></p>
                                <p x-text="checkoutForm.email"></p>
                                <p x-text="checkoutForm.phone"></p>
                                <p x-text="checkoutForm.address + ', ' + checkoutForm.city + ', ' + checkoutForm.district + ', ' + checkoutForm.province"></p>
                            </div>
                            
                            <div>
                                <h4 class="font-medium mb-4 text-lg border-b pb-2">Product Information</h4>
                                <p x-text="selectedProduct.name"></p>
                                <p x-text="'Size: ' + selectedSize"></p>
                                <p x-text="'Color: ' + selectedColor.name"></p>
                                <p x-text="'Price: PKR ' + (selectedProduct.salePrice || selectedProduct.price)"></p>
                                <p x-text="'Shipping: PKR ' + shippingCost"></p>
                                <p class="font-bold" x-text="'Total: PKR ' + ((selectedProduct.salePrice || selectedProduct.price) + shippingCost)"></p>
                            </div>
                        </div>
                        
                        <div class="border-t pt-6 mb-8">
                            <p><span class="font-medium">Payment Method:</span> <span x-text="paymentMethod === 'card' ? 'Credit/Debit Card' : paymentMethod === 'mobile' ? 'JazzCash/EasyPaisa' : 'Cash on Delivery'"></span></p>
                            <p><span class="font-medium">Estimated Delivery:</span> <span x-text="deliveryDays + ' days'"></span></p>
                            <p><span class="font-medium">Order Date:</span> <span x-text="new Date().toLocaleDateString()"></span></p>
                        </div>
                        
                        <div class="text-center">
                            <button @click="downloadPDF()" class="bg-primary text-white px-6 py-3 rounded-md font-medium hover:bg-gray-800 transition-colors mr-4 hover-lift">
                                <i class="fas fa-download mr-2"></i>Download Order Summary
                            </button>
                            <button @click="closeOrderConfirmation()" class="border border-primary text-primary px-6 py-3 rounded-md font-medium hover:bg-highlight transition-colors hover-lift">Continue Shopping</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Cart Notification -->
    <div class="cart-notification" :class="{'active': showCartNotification}">
        <div class="flex items-center">
            <i class="fas fa-check-circle text-gold mr-2"></i>
            <span>Item added to cart successfully!</span>
        </div>
    </div>
    
    <!-- Login Modal -->
    <div class="modal-overlay" :class="{'active': loginModalOpen}">
        <div class="modal-content">
            <button class="close-modal" @click="loginModalOpen = false">
                <i class="fas fa-times"></i>
            </button>
            <h2 class="text-3xl font-bold mb-6 text-center">Login to Your Account</h2>
            <form @submit.prevent="handleLogin()">
                <div class="mb-4">
                    <label class="block text-gray-700 mb-2" for="email">Email Address</label>
                    <input type="email" id="email" x-model="loginForm.email" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:border-gold" required>
                </div>
                <div class="mb-6">
                    <label class="block text-gray-700 mb-2" for="password">Password</label>
                    <input type="password" id="password" x-model="loginForm.password" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:border-gold" required>
                </div>
                <button type="submit" class="btn-premium w-full py-3 hover-lift">Sign In</button>
            </form>
            <div class="mt-4 text-center">
                <p class="text-gray-600">Don't have an account? 
                    <button @click="openRegisterModal(); loginModalOpen = false" class="text-gold font-medium hover:underline">Register here</button>
                </p>
            </div>
        </div>
    </div>    
    <!-- Admin Login Modal -->
    <div class="modal-overlay" :class="{'active': adminLoginModalOpen}">
        <div class="modal-content">
            <button class="close-modal" @click="adminLoginModalOpen = false">
                <i class="fas fa-times"></i>
            </button>
            <h2 class="text-3xl font-bold mb-6 text-center">Admin Login</h2>
            <form @submit.prevent="handleAdminLogin()">
                <div class="mb-4">
                    <label class="block text-gray-700 mb-2" for="adminEmail">Email Address</label>
                    <input type="email" id="adminEmail" x-model="adminLoginForm.email" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:border-gold" required>
                </div>
                <div class="mb-6">
                    <label class="block text-gray-700 mb-2" for="adminPassword">Password</label>
                    <input type="password" id="adminPassword" x-model="adminLoginForm.password" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:border-gold" required>
                </div>
                <button type="submit" class="btn-premium w-full py-3 hover-lift">Sign In</button>
            </form>
            <div class="mt-4 text-center">
                <button @click="openLoginModal(); adminLoginModalOpen = false" class="text-gold font-medium hover:underline">Back to User Login</button>
            </div>
        </div>
    </div>
    
    <!-- Register Modal -->
    <div class="modal-overlay" :class="{'active': registerModalOpen}">
        <div class="modal-content">
            <button class="close-modal" @click="registerModalOpen = false">
                <i class="fas fa-times"></i>
            </button>
            <h2 class="text-3xl font-bold mb-6 text-center">Create an Account</h2>
            <form @submit.prevent="handleUserRegister()">
                <div class="mb-4">
                    <label class="block text-gray-700 mb-2" for="regName">Full Name</label>
                    <input type="text" id="regName" x-model="userRegisterForm.name" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:border-gold" required>
                </div>
                <div class="mb-4">
                    <label class="block text-gray-700 mb-2" for="regEmail">Email Address</label>
                    <input type="email" id="regEmail" x-model="userRegisterForm.email" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:border-gold" required>
                </div>
                <div class="mb-4">
                    <label class="block text-gray-700 mb-2" for="regPhone">Phone Number</label>
                    <input type="tel" id="regPhone" x-model="userRegisterForm.phone" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:border-gold">
                </div>
                <div class="mb-4">
                    <label class="block text-gray-700 mb-2" for="regPassword">Password</label>
                    <input type="password" id="regPassword" x-model="userRegisterForm.password" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:border-gold" required>
                </div>
                <div class="mb-6">
                    <label class="block text-gray-700 mb-2" for="regConfirmPassword">Confirm Password</label>
                    <input type="password" id="regConfirmPassword" x-model="userRegisterForm.confirmPassword" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:border-gold" required>
                </div>
                <button type="submit" class="btn-premium w-full py-3 hover-lift">Create Account</button>
            </form>
            <div class="mt-4 text-center">
                <p class="text-gray-600">Already have an account? 
                    <button @click="openLoginModal(); registerModalOpen = false" class="text-gold font-medium hover:underline">Login here</button>
                </p>
            </div>
        </div>
    </div>
    
    <!-- Add Product Modal (Admin Only) -->
    <div class="modal-overlay" :class="{'active': addProductModalOpen}">
        <div class="modal-content max-w-4xl max-h-[90vh] overflow-y-auto">
            <button class="close-modal" @click="addProductModalOpen = false">
                <i class="fas fa-times"></i>
            </button>
            <h2 class="text-3xl font-bold mb-6 text-center">Add New Product</h2>
            
            <form @submit.prevent="addProduct()">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                    <div>
                        <div class="mb-4">
                            <label class="block text-gray-700 mb-2" for="productName">Product Name</label>
                            <input 
                                type="text" 
                                id="productName" 
                                x-model="newProduct.name"
                                class="w-full px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-gold"
                                required
                            >
                        </div>
                        
                        <div class="mb-4">
                            <label class="block text-gray-700 mb-2" for="productDescription">Description</label>
                            <textarea 
                                id="productDescription" 
                                x-model="newProduct.description"
                                class="w-full px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-gold"
                                rows="3"
                                required
                            ></textarea>
                        </div>
                        
                        <div class="mb-4">
                            <label class="block text-gray-700 mb-2" for="productPrice">Price (PKR)</label>
                            <input 
                                type="number" 
                                id="productPrice" 
                                x-model="newProduct.price"
                                class="w-full px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-gold"
                                min="0"
                                step="0.01"
                                required
                            >
                        </div>
                        
                        <div class="mb-4">
                            <label class="block text-gray-700 mb-2" for="productCategory">Category</label>
                            <select 
                                id="productCategory" 
                                x-model="newProduct.category"
                                class="w-full px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-gold"
                                required
                            >
                                <option value="">Select Category</option>
                                <template x-for="category in categories" :key="category.id">
                                    <option :value="category.id" x-text="category.name"></option>
                                </template>
                            </select>
                        </div>
                        
                        <div class="mb-4">
                            <label class="block text-gray-700 mb-2" for="sellerName">Seller/Brand Name</label>
                            <input 
                                type="text" 
                                id="sellerName" 
                                x-model="newProduct.seller"
                                class="w-full px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-gold"
                                required
                            >
                        </div>
                    </div>
                    
                    <div>
                <div class="mb-4">
                    <label class="block text-gray-700 mb-2">Front Image URL</label>
                    <input 
                        type="url" 
                        x-model="newProduct.frontImageUrl"
                        class="w-full px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-gold"
                        placeholder="https://example.com/image.jpg"
                        required
                    >
                    <p class="text-sm text-gray-500 mt-1">Enter public image URL for product card</p>
                </div>                        
                <div class="mb-4">
                    <label class="block text-gray-700 mb-2">Detail Image URLs (one per line)</label>
                    <textarea 
                        x-model="newProduct.detailImageUrls"
                        class="w-full px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-gold"
                        rows="3"
                        placeholder="https://example.com/image1.jpg&#10;https://example.com/image2.jpg"
                        required
                    ></textarea>
                    <p class="text-sm text-gray-500 mt-1">Enter multiple image URLs for product detail page (one URL per line)</p>
                </div>               
                <div class="mb-6">
                    <label class="block text-gray-700 mb-2">Available Sizes</label>
                    <div class="flex flex-wrap gap-2 mb-4">
                        <template x-for="(size, index) in newProduct.sizes" :key="index">
                            <div class="flex items-center space-x-2 bg-gray-50 p-2 rounded">
                                <input 
                                    type="text" 
                                    x-model="newProduct.sizes[index]"
                                    class="px-2 py-1 border border-gray-300 rounded-md w-16"
                                    placeholder="Size"
                                    required
                                >
                                <button type="button" @click="removeSize(index)" class="text-red-500">
                                    <i class="fas fa-trash"></i>
                                </button>
                            </div>
                        </template>
                        <button type="button" @click="addSize()" class="text-gold underline text-sm">+ Add Size</button>
                    </div>
                </div>
                
                <div class="mb-6">
                    <label class="block text-gray-700 mb-2">Available Colors & Stock</label>
                    <div class="space-y-4">
                        <template x-for="(color, colorIndex) in newProduct.colors" :key="colorIndex">
                            <div class="border p-4 rounded-md">
                                <div class="flex items-center space-x-4 mb-3">
                                    <div class="flex items-center space-x-2">
                                        <label class="text-gray-700">Color Name:</label>
                                        <input 
                                            type="text" 
                                            x-model="color.name"
                                            class="px-2 py-1 border border-gray-300 rounded-md"
                                            placeholder="e.g., Red"
                                            required
                                        >
                                    </div>
                                    <div class="flex items-center space-x-2">
                                        <label class="text-gray-700">Color Code:</label>
                                        <input 
                                            type="color" 
                                            x-model="color.code"
                                            class="w-10 h-10 border border-gray-300 rounded-md"
                                            required
                                        >
                                    </div>
                                    <button type="button" @click="removeColor(colorIndex)" class="text-red-500">
                                        <i class="fas fa-trash"></i>
                                    </button>
                                </div>
                                <div class="grid grid-cols-2 md:grid-cols-4 gap-2">
                                    <template x-for="size in newProduct.sizes" :key="size">
                                        <div class="flex items-center space-x-2">
                                            <label class="text-gray-700 w-8" x-text="size"></label>
                                            <input 
                                                type="number" 
                                                x-model="color.stock[size]"
                                                class="w-16 px-2 py-1 border border-gray-300 rounded-md"
                                                min="0"
                                                placeholder="Stock"
                                                required
                                            >
                                        </div>
                                    </template>
                                </div>
                            </div>
                        </template>
                        <button type="button" @click="addColor()" class="text-gold underline text-sm">+ Add Color</button>
                    </div>
                </div>
                
                <button type="submit" class="w-full btn-premium py-3 rounded-md font-medium shadow-md hover-lift">Add Product</button>
            </form>
        </div>
    </div>    
    <div class="modal-overlay" :class="{'active': editProductModalOpen}">
        <div class="modal-content max-w-4xl max-h-[90vh] overflow-y-auto">
            <button class="close-modal" @click="editProductModalOpen = false">
                <i class="fas fa-times"></i>
            </button>
            <h2 class="text-3xl font-bold mb-6 text-center">Edit Product</h2>
            
            <form @submit.prevent="updateProduct()">
                
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                    <div>
                        <label class="block text-gray-700 mb-2 font-bold">Product Name</label>
                        <input type="text" x-model="editingProduct.name" class="w-full px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-gold">
                    </div>
                    <div>
                        <label class="block text-gray-700 mb-2 font-bold">Price (PKR)</label>
                        <input type="number" step="0.01" x-model="editingProduct.price" class="w-full px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-gold">
                    </div>
                </div>

                <div class="mb-6">
                    <label class="block text-gray-700 mb-2 font-bold">Description</label>
                    <textarea x-model="editingProduct.description" rows="4" class="w-full px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-gold"></textarea>
                </div>

                <hr class="my-6 border-gray-200">

                <div class="mb-6">
                    <div class="flex justify-between items-center mb-2">
                        <label class="block text-gray-700 font-bold">Front Images (Main Display)</label>
                        <button type="button" @click="addEditFrontImage()" class="text-sm bg-green-100 text-green-700 px-3 py-1 rounded hover:bg-green-200 transition">+ Add Picture</button>
                    </div>
                    <div class="space-y-3">
                        <template x-for="(img, index) in editingProduct.frontImages" :key="'front-' + index">
                            <div class="flex gap-2 items-center bg-gray-50 p-2 rounded border">
                                <img :src="img" class="w-12 h-12 object-cover rounded border bg-white" onerror="this.src='https://via.placeholder.com/50?text=Invalid'">
                                <div class="flex-1">
                                    <input type="url" x-model="editingProduct.frontImages[index]" placeholder="Paste new image URL here to replace" class="w-full px-2 py-1 text-sm border border-gray-300 rounded focus:border-gold outline-none">
                                </div>
                                <button type="button" @click="removeEditFrontImage(index)" class="text-red-500 hover:text-red-700 p-2" title="Remove Picture">
                                    <i class="fas fa-trash"></i>
                                </button>
                            </div>
                        </template>
                        <div x-show="editingProduct.frontImages.length === 0" class="text-sm text-red-500 italic">No front images. Please add one.</div>
                    </div>
                </div>

                <div class="mb-6">
                    <div class="flex justify-between items-center mb-2">
                        <label class="block text-gray-700 font-bold">Detail Images (Gallery)</label>
                        <button type="button" @click="addEditDetailImage()" class="text-sm bg-green-100 text-green-700 px-3 py-1 rounded hover:bg-green-200 transition">+ Add Picture</button>
                    </div>
                    <div class="space-y-3">
                        <template x-for="(img, index) in editingProduct.detailImages" :key="'detail-' + index">
                            <div class="flex gap-2 items-center bg-gray-50 p-2 rounded border">
                                <img :src="img" class="w-12 h-12 object-cover rounded border bg-white" onerror="this.src='https://via.placeholder.com/50?text=Invalid'">
                                <div class="flex-1">
                                    <input type="url" x-model="editingProduct.detailImages[index]" placeholder="Paste new image URL here to replace" class="w-full px-2 py-1 text-sm border border-gray-300 rounded focus:border-gold outline-none">
                                </div>
                                <button type="button" @click="removeEditDetailImage(index)" class="text-red-500 hover:text-red-700 p-2" title="Remove Picture">
                                    <i class="fas fa-trash"></i>
                                </button>
                            </div>
                        </template>
                    </div>
                </div>

                <button type="submit" class="w-full btn-premium py-3 rounded-md font-medium shadow-md hover-lift">Save Changes</button>
            </form>
        </div>
    </div>
    <!-- Add Sale Modal (Admin Only) -->
    <div class="modal-overlay" :class="{'active': addSaleModalOpen}">
        <div class="modal-content max-w-2xl max-h-[90vh] overflow-y-auto">
            <button class="close-modal" @click="addSaleModalOpen = false">
                <i class="fas fa-times"></i>
            </button>
            <h2 class="text-3xl font-bold mb-6 text-center">Add Sale</h2>
            
            <form @submit.prevent="addSale()">
                <div class="mb-6">
                    <label class="block text-gray-700 mb-2" for="saleProduct">Select Product</label>
                    <select 
                        id="saleProduct" 
                        x-model="saleProductId"
                        class="w-full px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-gold"
                        required
                    >
                        <option value="">Select Product</option>
                        <template x-for="product in products" :key="product.id">
                            <option :value="product.id" x-text="product.name"></option>
                        </template>
                    </select>
                </div>
                
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                    <div>
                        <div class="mb-4">
                            <label class="block text-gray-700 mb-2" for="originalPrice">Original Price (PKR)</label>
                            <input 
                                type="number" 
                                id="originalPrice" 
                                x-model="saleForm.originalPrice"
                                class="w-full px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-gold"
                                min="0"
                                step="0.01"
                                required
                                readonly
                            >
                        </div>
                        
                        <div class="mb-4">
                            <label class="block text-gray-700 mb-2" for="salePrice">Sale Price (PKR)</label>
                            <input 
                                type="number" 
                                id="salePrice" 
                                x-model="saleForm.salePrice"
                                class="w-full px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-gold"
                                min="0"
                                step="0.01"
                                required
                            >
                        </div>
                    </div>
                    
                    <div class="flex items-center justify-center">
                        <div class="text-center">
                            <p class="text-gray-600 mb-2">Discount Percentage</p>
                            <p class="text-3xl font-bold text-gold" x-text="calculateSaleDiscount() + '%'"></p>
                        </div>
                    </div>
                </div>
                
                <button type="submit" class="w-full btn-premium py-3 rounded-md font-medium shadow-md hover-lift">Apply Sale</button>
            </form>
        </div>
    </div>
    
    <!-- Change Credentials Modal (Admin Only) -->
    <div class="modal-overlay" :class="{'active': changeCredentialsModalOpen}">
        <div class="modal-content max-w-lg">
            <button class="close-modal" @click="changeCredentialsModalOpen = false">
                <i class="fas fa-times"></i>
            </button>
            <h2 class="text-3xl font-bold mb-6 text-center">Change Admin Credentials</h2>
            
            <form @submit.prevent="changeCredentials()">
                <div class="mb-4">
                    <label class="block text-gray-700 mb-2" for="currentEmail">Current Email</label>
                    <input 
                        type="email" 
                        id="currentEmail" 
                        x-model="credentialsForm.currentEmail"
                        class="w-full px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-gold"
                        required
                    >
                </div>
                
                <div class="mb-4">
                    <label class="block text-gray-700 mb-2" for="newEmail">New Email</label>
                    <input 
                        type="email" 
                        id="newEmail" 
                        x-model="credentialsForm.newEmail"
                        class="w-full px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-gold"
                        required
                    >
                </div>
                
                <div class="mb-4">
                    <label class="block text-gray-700 mb-2" for="currentPassword">Current Password</label>
                    <input 
                        type="password" 
                        id="currentPassword" 
                        x-model="credentialsForm.currentPassword"
                        class="w-full px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-gold"
                        required
                    >
                </div>
                
                <div class="mb-6">
                    <label class="block text-gray-700 mb-2" for="newPassword">New Password</label>
                    <input 
                        type="password" 
                        id="newPassword" 
                        x-model="credentialsForm.newPassword"
                        class="w-full px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-gold"
                        required
                    >
                </div>
                
                <button type="submit" class="w-full btn-premium py-3 rounded-md font-medium shadow-md hover-lift">Update Credentials</button>
            </form>
        </div>
    </div>
<!-- Add Category Modal (Admin Only) -->
       <div class="modal-overlay" :class="{'active': addCategoryModalOpen}">
           <div class="modal-content max-w-2xl">
               <button class="close-modal" @click="addCategoryModalOpen = false">
                   <i class="fas fa-times"></i>
               </button>
               <h2 class="text-3xl font-bold mb-6 text-center">Add New Category</h2>
               
               <form @submit.prevent="addCategory()">
                   <div class="mb-4">
                       <label class="block text-gray-700 mb-2" for="categoryName">Category Name</label>
                       <input 
                           type="text" 
                           id="categoryName" 
                           x-model="newCategory.name"
                           class="w-full px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-gold"
                           required
                       >
                   </div>
                   
                   <div class="mb-4">
                       <label class="block text-gray-700 mb-2" for="categoryDescription">Description</label>
                       <textarea 
                           id="categoryDescription" 
                           x-model="newCategory.description"
                           class="w-full px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-gold"
                           rows="3"
                           required
                       ></textarea>
                   </div>
                   
                   <div class="mb-6">  
                       <label class="block text-gray-700 mb-2" for="categoryImageUrl">Category Image URL</label>  
                       <input   
                           type="url"   
                           id="categoryImageUrl"   
                           x-model="newCategory.imageUrl"  
                           class="w-full px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-gold"  
                           placeholder="https://example.com/category-image.jpg"  
                           required  
                       >  
                       <p class="text-sm text-gray-500 mt-1">Enter public image URL for the category</p>  
                   </div>
                   
                   <button type="submit" class="w-full btn-premium py-3 rounded-md font-medium shadow-md hover-lift">Add Category</button>
               </form>
           </div>
       </div>
       
       <!-- Remove Category Modal (Admin Only) -->
       <div class="modal-overlay" :class="{'active': removeCategoryModalOpen}">
           <div class="modal-content max-w-lg">
               <button class="close-modal" @click="removeCategoryModalOpen = false">
                   <i class="fas fa-times"></i>
               </button>
               <h2 class="text-3xl font-bold mb-6 text-center">Remove Category</h2>
               
               <form @submit.prevent="removeCategory()">
                   <div class="mb-6">
                       <label class="block text-gray-700 mb-2" for="categoryToRemove">Select Category to Remove</label>
                       <select 
                           id="categoryToRemove" 
                           x-model="categoryToRemove"
                           class="w-full px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-gold"
                           required
                       >
                           <option value="">Select Category</option>
                           <template x-for="category in categories" :key="category.id">
                               <option :value="category.id" x-text="category.name"></option>
                           </template>
                       </select>
                   </div>
                   
                   <div class="mb-4" x-show="categoryToRemove">
                       <p class="text-red-600 font-medium">Warning: This action will permanently remove the category and cannot be undone.</p>
                       <p class="text-gray-600 mt-2" x-show="getProductCountByCategory(categoryToRemove) > 0">
                           There are <span x-text="getProductCountByCategory(categoryToRemove)" class="font-bold"></span> products in this category. 
                           These products will also be removed.
                       </p>
                   </div>
                   
                   <button type="submit" class="w-full bg-red-600 text-white py-3 rounded-md font-medium shadow-md hover:bg-red-700 transition-colors">Remove Category</button>
               </form>
           </div>
       </div> 
                        <div class="modal-content max-w-lg">  
                            <button class="close-modal" @click="removeCategoryModalOpen = false">  
                                <i class="fas fa-times"></i>  
                            </button>  
                            <h2 class="text-3xl font-bold mb-6 text-center">Remove Category</h2>  
                            
                            <form @submit.prevent="removeCategory()">  
                                <div class="mb-6">  
                                    <label class="block text-gray-700 mb-2" for="categoryToRemove">Select Category to Remove</label>  
                                    <select   
                                        id="categoryToRemove"   
                                        x-model="categoryToRemove"  
                                        class="w-full px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-gold"  
                                        required  
                                    >  
                                        <option value="">Select Category</option>  
                                        <template x-for="category in categories" :key="category.id">  
                                            <option :value="category.id" x-text="category.name"></option>  
                                        </template>  
                                    </select>  
                                </div>  
                                
                                <div class="mb-4" x-show="categoryToRemove">  
                                    <p class="text-red-600 font-medium">Warning: This action will permanently remove the category and cannot be undone.</p>  
                                    <p class="text-gray-600 mt-2" x-show="getProductCountByCategory(categoryToRemove) > 0">  
                                        There are <span x-text="getProductCountByCategory(categoryToRemove)" class="font-bold"></span> products in this category.   
                                        These products will also be removed.  
                                    </p>  
                                </div>  
                                
                                <button type="submit" class="w-full bg-red-600 text-white py-3 rounded-md font-medium shadow-md hover:bg-red-700 transition-colors">Remove Category</button>  
                            </form>  
                        </div>  
                    </div>  
                    <section class="py-8 bg-white border-t border-gray-100">
                        <div class="container mx-auto px-6 text-center">
                            <h2 class="text-2xl font-bold mb-4">Shop the Best Hoodies & Track Suits in Pakistan</h2>
                            <p class="text-gray-500 text-sm max-w-4xl mx-auto">
                                Welcome to Trend Trove, your ultimate destination for winter fashion. We specialize in 
                                <strong>premium men's hoodies</strong>, <strong>oversized tracksuits</strong>, and 
                                comfortable <strong>fleece joggers</strong>. Whether you are looking for a 
                                <em>black zip-up hoodie</em> or a <em>complete tracksuit set</em>, we offer 
                                high-quality fabrics with cash on delivery across Lahore, Karachi, Islamabad, and all of Pakistan.
                            </p>
                        </div>
</section>    
    <!-- Footer -->
    <footer class="py-12 bg-highlight">
        <div class="container mx-auto px-6">
            <div class="grid grid-cols-1 md:grid-cols-4 gap-8">
                <div>
                    <div class="logo text-2xl mb-4">
                        <span class="text-gold">T</span>rend<span class="text-gold">T</span>rove
                    </div>
                    <p class="text-gray-600 mb-4">Premium fashion for the modern individual. Quality meets style in every piece.</p>
                    <div class="flex space-x-4">
                        <a href="#" class="text-gray-600 hover:text-gold transition-colors hover-lift">
                            <i class="fab fa-facebook-f"></i>
                        </a>
                        <a href="#" class="text-gray-600 hover:text-gold transition-colors hover-lift">
                            <i class="fab fa-instagram"></i>
                        </a>
                        <a href="#" class="text-gray-600 hover:text-gold transition-colors hover-lift">
                            <i class="fab fa-pinterest-p"></i>
                        </a>
                        <a href="#" class="text-gray-600 hover:text-gold transition-colors hover-lift">
                            <i class="fab fa-twitter"></i>
                        </a>
                    </div>
                </div>
                
                <div>
                    <h3 class="font-semibold text-lg mb-4">Shop</h3>
                    <ul class="space-y-2">
                        <li><a href="#" class="footer-link text-gray-600">New Arrivals</a></li>
                        <li><a href="#" class="footer-link text-gray-600">Men's Collection</a></li>
                        <li><a href="#" class="footer-link text-gray-600">Accessories</a></li>
                        <li><a href="#" class="footer-link text-gray-600">Sale</a></li>
                    </ul>
                </div>
                
                <div>
                    <h3 class="font-semibold text-lg mb-4">Information</h3>
                    <ul class="space-y-2">
                        <li><a href="#" class="footer-link text-gray-600">About Us</a></li>
                        <li><a href="https://wa.me/message/TY5U3IM2LB6HJ1" target="_blank" class="social-link">Contact</a>
                        <li><a href="#" class="footer-link text-gray-600">Shipping & Returns</a></li>
                    </ul>
                </div>
                
                <div>
                    <h3 class="font-semibold text-lg mb-4">Contact</h3>
                    <ul class="space-y-2">
                        <li class="text-gray-600">03205270810</li>
                        <li class="text-gray-600">03130685030</li>
                        <li class="text-gray-600">trendtrove2989@gmail.com</li>
                    </ul>
                </div>
            </div>
            
            <div class="border-t border-gray-200 mt-12 pt-8 text-center text-gray-500">
                <p>Â© 2023 TrendTrove. All rights reserved.</p>
            </div>
        </div>
    </footer>
    <script src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js" defer></script>
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/@emailjs/browser@3/dist/email.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    
<script type="module">
    // 1. Imports (Fixed Version to 10.7.1)
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
    import { getAnalytics } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-analytics.js";
    // ADDED setDoc and getDoc here
    import { 
        getFirestore, collection, getDocs, addDoc, deleteDoc, doc, updateDoc, query, where, setDoc, getDoc 
    } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";
    import { 
        getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword, signOut, onAuthStateChanged 
    } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";

    // 2. Your Firebase Configuration
    const firebaseConfig = {
        apiKey: "AIzaSyCUZnyyGqXDmc0kMlk91Lyq33Ug6WvJvTY",
        authDomain: "trend-trove-40382.firebaseapp.com",
        projectId: "trend-trove-40382",
        storageBucket: "trend-trove-40382.firebasestorage.app",
        messagingSenderId: "410397186514",
        appId: "1:410397186514:web:e8a8d986e21f939612100b"
    };

    // 3. Initialize Firebase
    try {
        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);
        const auth = getAuth(app);

        // 4. CRITICAL: Bind to Window so Alpine.js can see it
        window.db = db;
        window.auth = auth;
        // ADDED setDoc and getDoc here as well
        window.fs = { collection, getDocs, addDoc, deleteDoc, doc, updateDoc, query, where, setDoc, getDoc };
        window.fireAuth = { createUserWithEmailAndPassword, signInWithEmailAndPassword, signOut, onAuthStateChanged };

        console.log("Firebase Initialized Successfully");
    } catch (error) {
        console.error("Firebase Initialization Failed:", error);
    }
</script> 
    <script>
        function app() {
            return {
                // State
                addCategoryModalOpen: false,
                removeCategoryModalOpen: false,
                newCategory: {
                    name: '',
                    description: '',
                    imageUrl: ''
                },
                categoryToRemove: '',
                currentPage: 'home',
                previousPage: 'home',
                mobileMenuOpen: false,
                loginModalOpen: false,
                adminLoginModalOpen: false,
                registerModalOpen: false,
                addProductModalOpen: false,
                addSaleModalOpen: false,
                changeCredentialsModalOpen: false,
                isAdmin: false,
                isLoggedIn: false,
                showCartNotification: false,
                cartOpen: false,
                cartCount: 0,
                cartItems: [],
                notification: {
                    show: false,
                    message: '',
                    type: 'success'
                },
                selectedImageIndex: 0,
                selectedSize: '',
                selectedColor: null,
                selectedProduct: {},
                selectedCategory: {},
                categoryProducts: [],
                paymentMethod: 'cod',
                deliveryDays: 5,
                shippingCost: 200,
                activeBannerIndex: 0,
                quantity: 1,
                saleProductId: '',
                // --- ADDED FOR EDITING ---
                editProductModalOpen: false,
                editingProduct: {
                    id: '',
                    name: '',
                    description: '',
                    price: 0,
                    frontImages: [],
                    detailImages: [],
                    sizes: [],
                    colors: []
                },
                // -------------------------                
                // --- Add this block ---
                productReviews: [],
                userCanReview: false,
                newReview: { rating: 0, comment: '' },
                // ---------------------
                // User Authentication State
                currentUser: {
                    id: '',
                    name: '',
                    email: '',
                    phone: '',
                    createdAt: ''
                },
                userLoginForm: {
                    email: '',
                    password: ''
                },
                userRegisterForm: {
                    name: '',
                    email: '',
                    phone: '',
                    password: '',
                    confirmPassword: ''
                },
                adminLoginForm: {
                    email: '',
                    password: ''
                },
                userOrders: [],
                userWishlist: [],

                // Methods for loading animation
                startPageTransition(targetPage) {
                    const transitionOverlay = document.querySelector('.transition-overlay');
                    const loaderContainer = document.querySelector('.loader-container');
                    
                    // Store the target page
                    this.nextPage = targetPage;
                    
                    // Activate transition overlay WITHOUT hiding current page
                    transitionOverlay.classList.add('active');
                    
                    // After shutters close, show loader
                    setTimeout(() => {
                        // Show loader
                        loaderContainer.classList.add('active');
                        
                        // Simulate loading time
                        setTimeout(() => {
                            // Hide loader
                            loaderContainer.classList.remove('active');
                            
                            // Update current page and show target page
                            setTimeout(() => {
                                // Hide current page first
                                document.querySelectorAll('.page-container').forEach(page => {
                                    page.classList.remove('active');
                                });
                                
                                // Update current page
                                this.previousPage = this.currentPage;
                                this.currentPage = targetPage;
                                
                                // Show the target page
                                setTimeout(() => {
                                    document.querySelectorAll('.page-container').forEach(page => {
                                        if (page.getAttribute('x-show') === `currentPage === '${targetPage}'`) {
                                            page.classList.add('active');
                                        }
                                    });
                                    
                                    // Start closing animation
                                    transitionOverlay.classList.remove('active');
                                    transitionOverlay.classList.add('closing');
                                    
                                    // Reset for next transition
                                    setTimeout(() => {
                                        transitionOverlay.classList.remove('closing');
                                        window.scrollTo(0, 0);
                                    }, 800);
                                }, 50);
                            }, 300);
                        }, 1500); // Loading duration
                    }, 800); // Time for shutters to close
                },
                addSize() {
                    this.newProduct.sizes.push('');
                },

                removeSize(index) {
                    this.newProduct.sizes.splice(index, 1);
                    // Also remove this size from all color stock objects
                    this.newProduct.colors.forEach(color => {
                        delete color.stock[this.newProduct.sizes[index]];
                    });
                },

                addColor() {
                    const stock = {};
                    this.newProduct.sizes.forEach(size => {
                        stock[size] = 0;
                    });
                    
                    this.newProduct.colors.push({
                        name: '',
                        code: '#000000',
                        stock: stock
                    });
                },

                removeColor(index) {
                    this.newProduct.colors.splice(index, 1);
                },

                async addProduct() {
                    // 1. Validate required fields (Exact same as your original code)
                    if (!this.newProduct.frontImageUrl) {
                        alert('Please add a front image URL');
                        return;
                    }
                
                    if (!this.newProduct.detailImageUrls) {
                        alert('Please add detail image URLs');
                        return;
                    }
                
                    if (this.newProduct.sizes.length === 0) {
                        alert('Please add at least one size');
                        return;
                    }
                
                    if (this.newProduct.colors.length === 0) {
                        alert('Please add at least one color');
                        return;
                    }
                
                    // Convert detailImageUrls string to array
                    const detailImagesArray = this.newProduct.detailImageUrls
                        .split('\n')
                        .map(url => url.trim())
                        .filter(url => url.length > 0);
                
                    if (detailImagesArray.length === 0) {
                        alert('Please add at least one valid detail image URL');
                        return;
                    }
                
                    // 2. Determine stock status (Exact same logic)
                    let totalStock = 0;
                    this.newProduct.colors.forEach(color => {
                        Object.values(color.stock).forEach(stock => {
                            totalStock += parseInt(stock || 0);
                        });
                    });
                
                    let stockStatus = 'in-stock';
                    if (totalStock === 0) {
                        stockStatus = 'out-of-stock';
                    } else if (totalStock < 10) {
                        stockStatus = 'low-stock';
                    }
                
                    // 3. Create the data object to send to Firebase
                    const productData = {
                        name: this.newProduct.name,
                        description: this.newProduct.description,
                        price: parseFloat(this.newProduct.price),
                        category: this.newProduct.category,
                        seller: this.newProduct.seller,
                        frontImages: [this.newProduct.frontImageUrl],
                        detailImages: detailImagesArray,
                        sizes: [...this.newProduct.sizes],
                        colors: JSON.parse(JSON.stringify(this.newProduct.colors)),
                        stockStatus: stockStatus,
                        createdAt: new Date().toISOString() // Added timestamp for sorting later if needed
                    };
                
                    // 4. Save to Firebase Database
                    try {
                        // This adds the document to the "products" collection in Firebase
                        const docRef = await window.fs.addDoc(window.fs.collection(window.db, "products"), productData);
                        
                        // Update local state so it shows up immediately on the screen
                        this.products.unshift({
                            id: docRef.id, // Use the real ID generated by Firebase
                            ...productData
                        });
                
                        // 5. Reset form and close modal (Same as original)
                        this.newProduct = {
                            name: '',
                            description: '',
                            price: 0,
                            category: '',
                            seller: 'D-Ground Seller',
                            frontImageUrl: '',
                            detailImageUrls: '',
                            sizes: ['S', 'M', 'L', 'XL'],
                            colors: [{
                                name: 'Red',
                                code: '#FF0000',
                                stock: { 'S': 10, 'M': 15, 'L': 8, 'XL': 5 }
                            }]
                        };
                
                        this.addProductModalOpen = false;
                        alert('Product added successfully to Database!');
                
                    } catch (error) {
                        console.error("Error adding product: ", error);
                        alert("Error saving to database: " + error.message);
                    }
                },                
                // Categories
                categories: [

                ],
                
                // Forms
                loginForm: {
                    email: '',
                    password: ''
                },
                checkoutForm: {
                    fullName: '',
                    email: '',
                    phone: '',
                    province: '',
                    district: '',
                    city: '',
                    address: ''
                },
                newProduct: {
                    name: '',
                    description: '',
                    price: 0,
                    category: '',
                    seller: 'D-Ground Seller',
                    frontImageUrl: '',
                    detailImageUrls: '',
                    sizes: ['S', 'M', 'L', 'XL'],
                    colors: [
                        {
                            name: 'Red',
                            code: '#FF0000',
                            stock: {
                                'S': 10,
                                'M': 15,
                                'L': 8,
                                'XL': 5
                            }
                        }
                    ]
                },
                saleForm: {
                    originalPrice: 0,
                    salePrice: 0
                },
                credentialsForm: {
                    currentEmail: '',
                    newEmail: '',
                    currentPassword: '',
                    newPassword: ''
                },
                
                // Sample Products Data
                products: [],
                
                // Methods
                // Inside your app() function, replace the init() method with this:
                
                async init() {
                    // 1. Initialize Animation & Loading
                    emailjs.init("cOxLQwNCTH32Cd4np");
                    this.initializeAnimations();
                    this.simulateLoading();
                    this.initializeScrollEvents();
                
                    // 2. WAIT for Firebase to initialize
                    let attempts = 0;
                    while ((!window.fs || !window.db) && attempts < 50) {
                        await new Promise(resolve => setTimeout(resolve, 100));
                        attempts++;
                    }
                
                    if (!window.fs || !window.db) {
                        console.error("Firebase failed to load in time.");
                        return;
                    }
                
                    // 3. Fetch Categories
                    try {
                        const catSnapshot = await window.fs.getDocs(window.fs.collection(window.db, "categories"));
                        this.categories = catSnapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }));
                    } catch (e) { console.error("Error fetching categories:", e); }
                
                    // 4. Fetch Products
                    try {
                        const prodSnapshot = await window.fs.getDocs(window.fs.collection(window.db, "products"));
                        this.products = prodSnapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }));
                    } catch (e) { console.error("Error fetching products:", e); }
                
                    // 5. Listen for User Auth State Changes (UPDATED TO FETCH NAME)
                    if (window.fireAuth && window.auth) {
                        window.fireAuth.onAuthStateChanged(window.auth, async (user) => {
                            if (user) {
                                this.isLoggedIn = true;
                                let userName = user.displayName || 'User';
                                let userPhone = '';

                                // Fetch User Data from Firestore
                                try {
                                    const userDocRef = window.fs.doc(window.db, "users", user.uid);
                                    const userDoc = await window.fs.getDoc(userDocRef);
                                    if (userDoc.exists()) {
                                        const data = userDoc.data();
                                        userName = data.name || userName;
                                        userPhone = data.phone || '';
                                    }
                                } catch(e) { console.error("Error fetching user profile", e); }

                                this.currentUser = {
                                    id: user.uid,
                                    email: user.email,
                                    name: userName,
                                    phone: userPhone
                                };
                                this.loadUserOrders(user.email); 
                            } else {
                                this.isLoggedIn = false;
                                this.currentUser = {};
                                this.userOrders = [];
                            }
                        });
                    }
                
                    // Determine active page
                    setTimeout(() => {
                        document.querySelectorAll('.page-container').forEach(page => {
                            if (page.getAttribute('x-show') === 'currentPage === \'home\'') {
                                page.classList.add('active');
                            }
                        });
                    }, 100);
                },                
                // Add this helper method immediately after init()
                async loadUserOrders(email) {
                    try {
                        const q = window.fs.query(
                            window.fs.collection(window.db, "orders"), 
                            window.fs.where("shipping.email", "==", email)
                        );
                        const querySnapshot = await window.fs.getDocs(q);
                        this.userOrders = querySnapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }));
                    } catch (e) { console.error("Error loading orders", e); }
                },
                // --- Add these functions ---
                checkReviewEligibility(productId) {
                    if (!this.isLoggedIn) {
                        this.userCanReview = false;
                        return;
                    }
                    // Check if user has an order containing this product ID
                    this.userCanReview = this.userOrders.some(order => 
                        order.items && order.items.some(item => item.id === productId)
                    );
                },
                
                async fetchReviews(productId) {
                    this.productReviews = []; 
                    try {
                        const q = window.fs.query(
                            window.fs.collection(window.db, "reviews"),
                            window.fs.where("productId", "==", productId)
                        );
                        const querySnapshot = await window.fs.getDocs(q);
                        this.productReviews = querySnapshot.docs.map(doc => doc.data());
                    } catch (error) {
                        console.error("Error fetching reviews:", error);
                    }
                },
                
                async submitReview() {
                    if (this.newReview.rating === 0) { alert("Please select a star rating."); return; }
                    if (!this.newReview.comment) { alert("Please write a comment."); return; }
                
                    const reviewData = {
                        productId: this.selectedProduct.id,
                        userId: this.currentUser.id,
                        userName: this.currentUser.name,
                        rating: this.newReview.rating,
                        comment: this.newReview.comment,
                        date: new Date().toLocaleDateString()
                    };
                
                    try {
                        await window.fs.addDoc(window.fs.collection(window.db, "reviews"), reviewData);
                        this.productReviews.push(reviewData);
                        this.newReview = { rating: 0, comment: '' };
                        this.showToast("Review submitted successfully!", "success");
                    } catch (error) {
                        this.showToast("Failed to submit review", "error");
                    }
                },
                // ----------------------------                
                // User Authentication Methods
                checkUserLoginStatus() {
                    const user = localStorage.getItem('trendtrove_user');
                    if (user) {
                        this.currentUser = JSON.parse(user);
                        this.isLoggedIn = true;
                        
                        // Load user cart from localStorage
                        const userCart = localStorage.getItem(`trendtrove_cart_${this.currentUser.id}`);
                        if (userCart) {
                            this.cartItems = JSON.parse(userCart);
                            this.cartCount = this.cartItems.reduce((total, item) => total + item.quantity, 0);
                        }
                        
                        // Load user orders from localStorage
                        const userOrders = localStorage.getItem(`trendtrove_orders_${this.currentUser.id}`);
                        if (userOrders) {
                            this.userOrders = JSON.parse(userOrders);
                        }
                    }
                    
                    // Check admin login status
                    const admin = localStorage.getItem('trendtrove_admin');
                    if (admin) {
                        this.isAdmin = true;
                    }
                },
                
                openLoginModal() {
                    this.loginModalOpen = true;
                },
                
                openAdminLoginModal() {
                    this.adminLoginModalOpen = true;
                },
                
                openRegisterModal() {
                    this.registerModalOpen = true;
                },
                
               handleLogin() {
                   // 1. Admin check (Keeping your hardcoded admin check as requested)
                   if (this.loginForm.email === 'admin@trendtrove.com' && this.loginForm.password === 'admin123') {
                       this.isAdmin = true;
                       this.loginModalOpen = false;
                       this.loginForm = { email: '', password: '' };
                       localStorage.setItem('trendtrove_admin', 'true');
                       alert('Admin login successful!');
                       return;
                   }
               
                   // 2. Firebase User Login (Replaces the array search logic)
                   window.fireAuth.signInWithEmailAndPassword(window.auth, this.loginForm.email, this.loginForm.password)
                       .then((userCredential) => {
                           // Signed in
                           const user = userCredential.user;
                           
                           // The 'init()' function has a listener (onAuthStateChanged) 
                           // that will automatically detect this login and update `this.currentUser`
                           // and load the cart/orders. We just close the modal here.
               
                           this.loginModalOpen = false;
                           this.loginForm = { email: '', password: '' };
                           alert('Login successful!');
                       })
                       .catch((error) => {
                           alert('Invalid email or password. Please try again.');
                           console.error(error);
                       });
               },                
                handleUserRegister() {
                    if (this.userRegisterForm.password !== this.userRegisterForm.confirmPassword) {
                        alert('Passwords do not match. Please try again.');
                        return;
                    }
                    window.fireAuth.createUserWithEmailAndPassword(window.auth, this.userRegisterForm.email, this.userRegisterForm.password)
                        .then(async (userCredential) => {
                            const user = userCredential.user;
                            
                            // Prepare user data
                            const userData = {
                                uid: user.uid,
                                name: this.userRegisterForm.name,
                                email: this.userRegisterForm.email,
                                phone: this.userRegisterForm.phone,
                                createdAt: new Date().toISOString()
                            };

                            // Save to Firestore "users" collection
                            try {
                                await window.fs.setDoc(window.fs.doc(window.db, "users", user.uid), userData);
                                
                                // Update local state immediately so name shows without refresh
                                this.currentUser = {
                                    id: user.uid,
                                    name: userData.name,
                                    email: userData.email,
                                    phone: userData.phone
                                };
                            } catch (error) {
                                console.error("Error saving user data:", error);
                            }

                            this.registerModalOpen = false;
                            this.userRegisterForm = { name: '', email: '', phone: '', password: '', confirmPassword: '' };
                            alert('Registration successful! You are now logged in.');
                        })
                        .catch((error) => {
                            const errorMessage = error.message;
                            if (error.code === 'auth/email-already-in-use') {
                                alert('An account with this email already exists. Please login instead.');
                            } else {
                                alert('Registration failed: ' + errorMessage);
                            }
                        });
                },                
                userLogout() {
                    window.fireAuth.signOut(window.auth).then(() => {
                        // Sign-out successful.
                        this.isLoggedIn = false;
                        this.currentUser = { id: '', name: '', email: '', phone: '', createdAt: '' };
                        this.cartItems = [];
                        this.cartCount = 0;
                        this.userOrders = []; // Clear orders on logout
                        // localStorage.removeItem('trendtrove_user'); // No longer needed
                        alert('Logged out successfully!');
                    }).catch((error) => {
                        // An error happened.
                        console.error('Logout error', error);
                    });
                },
                
                showUserProfile() {
                    this.startPageTransition('user-profile');
                },
                
                showOrderHistory() {
                    this.startPageTransition('order-history');
                },
                
                initializeAnimations() {
                    // Fade in elements on scroll
                    const fadeElements = document.querySelectorAll('.fade-in');
                    const fadeObserver = new IntersectionObserver((entries) => {
                        entries.forEach(entry => {
                            if (entry.isIntersecting) {
                                entry.target.classList.add('visible');
                            }
                        });
                    }, { threshold: 0.1 });
                    
                    fadeElements.forEach(el => fadeObserver.observe(el));
                },
                
                simulateLoading() {
                    // 1. Initial Logic: Handle the Loading Bar (Optional, but good for UX)
                    const loadingBar = document.getElementById('loadingBar');
                    loadingBar.style.display = 'block';
                    loadingBar.style.opacity = '1';
                    loadingBar.style.width = '0%';
                    
                    let width = 0;
                    const interval = setInterval(() => {
                        if (width >= 100) {
                            clearInterval(interval);
                            loadingBar.style.opacity = '0';
                            setTimeout(() => { loadingBar.style.display = 'none'; }, 300);
                        } else {
                            width += 5;
                            loadingBar.style.width = width + '%';
                        }
                    }, 50);
                
                    // 2. New Logic: Handle the Opening Animation (Stage 3)
                    // We wait 2000ms (2 seconds) to let the user see the logo/loader, then open.
                    setTimeout(() => {
                        const transitionOverlay = document.querySelector('.transition-overlay');
                        const loaderContainer = document.querySelector('.loader-container');
                
                        // Step A: Fade out the Newton's Cradle
                        if(loaderContainer) loaderContainer.classList.remove('active');
                
                        // Step B: Slide open the shutters
                        if(transitionOverlay) {
                            transitionOverlay.classList.remove('active'); // Remove closed state
                            transitionOverlay.classList.add('closing');   // Trigger opening animation logic from CSS
                            
                            // Clean up classes after animation is done (0.8s matches your CSS)
                            setTimeout(() => {
                                transitionOverlay.classList.remove('closing');
                            }, 800);
                        }
                    }, 2000); // Change 2000 to however many milliseconds you want the load to last
                },
                
                initializeScrollEvents() {
                    // Navbar background on scroll
                    window.addEventListener('scroll', () => {
                        const navbar = document.getElementById('navbar');
                        if (window.scrollY > 50) {
                            navbar.classList.add('bg-white', 'shadow-md');
                            navbar.classList.remove('bg-transparent');
                        } else {
                            navbar.classList.remove('bg-white', 'shadow-md');
                            navbar.classList.add('bg-transparent');
                        }
                    });
                },
                // Add this method to handle page transition
                showAllCollectionsPage() {
                    this.startPageTransition('all-collections');
                },
                
                // Add this helper method for professional notifications
                showToast(message, type = 'success') {
                    this.notification.message = message;
                    this.notification.type = type;
                    this.notification.show = true;
                    
                    // Hide after 3 seconds
                    setTimeout(() => {
                        this.notification.show = false;
                    }, 3000);
                },                
                scrollToProducts() {
                    document.getElementById('products').scrollIntoView({ behavior: 'smooth' });
                },
                
                hideLoadingBar() {
                    const loadingBar = document.getElementById('loadingBar');
                    loadingBar.style.display = 'none';
                    loadingBar.style.width = '0%';
                    loadingBar.style.opacity = '0';
                },
                
                showHomePage() {
                    this.startPageTransition('home');
                },
                
                showAllProductsPage() {
                    this.startPageTransition('all-products');
                },
                
                showPreviousPage() {
                    this.startPageTransition(this.previousPage);
                },
                
                showCategoryPage(categoryId) {
                    this.selectedCategory = this.categories.find(cat => cat.id === categoryId);
                    this.categoryProducts = this.products.filter(product => product.category === categoryId);
                    this.previousPage = this.currentPage;
                    this.startPageTransition('category-products');
                },
                
                showProductDetail(product) {
                    this.selectedProduct = product;
                    this.selectedImageIndex = 0;
                    this.selectedSize = '';
                    this.selectedColor = null;
                    // --- ADD THESE 3 LINES HERE ---
                    this.newReview = { rating: 0, comment: '' }; 
                    this.checkReviewEligibility(product.id);
                    this.fetchReviews(product.id);
                    this.previousPage = this.currentPage;
                    this.startPageTransition('product-detail');
                },
                
                selectColor(color) {
                    this.selectedColor = color;

                },
                
                selectSize(size) {
                    this.selectedSize = size;
                },
                
                getStockForColorAndSize(colorCode, size) {
                    // Safe check: if data isn't loaded yet
                    if (!this.selectedProduct || !this.selectedProduct.colors) return 0;
                    
                    const color = this.selectedProduct.colors.find(c => c.code === colorCode);
                    
                    // Check if color exists and has stock for the specific size
                    if (color && color.stock && color.stock[size] !== undefined) {
                        return parseInt(color.stock[size]); 
                    }
                    return 0;
                },
                
                showAdminDashboard() {
                    this.startPageTransition('admin-dashboard');
                },
                
                logout() {
                    this.isAdmin = false;
                    localStorage.removeItem('trendtrove_admin');
                    alert('Admin logged out successfully!');
                },
                
                addToCart(product) {
                    if (!this.isLoggedIn) {
                        this.openLoginModal();
                        return;
                    }
                    
                    if (!this.selectedColor) {
                        alert('Please select a color');
                        return;
                    }
                    if (!this.selectedSize) {
                        alert('Please select a size');
                        return;
                    }
                    
                    const stock = this.getStockForColorAndSize(this.selectedColor.code, this.selectedSize);
                    if (stock <= 0) {
                        alert('Selected color and size combination is out of stock');
                        return;
                    }
                    
                    const cartItem = {
                        ...product,
                        size: this.selectedSize,
                        color: this.selectedColor,
                        quantity: this.quantity
                    };
                    
                    this.cartItems.push(cartItem);
                    this.cartCount += this.quantity;
                    this.showCartNotification = true;
                    
                    localStorage.setItem(`trendtrove_cart_${this.currentUser.id}`, JSON.stringify(this.cartItems));
                    
                    setTimeout(() => {
                        this.showCartNotification = false;
                    }, 3000);
                    
                    // Show cart
                    this.cartOpen = true;
                },
                
                removeFromCart(productId) {
                    const itemIndex = this.cartItems.findIndex(item => item.id === productId);
                    if (itemIndex !== -1) {
                        this.cartCount -= this.cartItems[itemIndex].quantity;
                        this.cartItems.splice(itemIndex, 1);
                        
                        // Update localStorage
                        localStorage.setItem(`trendtrove_cart_${this.currentUser.id}`, JSON.stringify(this.cartItems));
                    }
                },
                
                buyNow(product) {
                    if (!this.isLoggedIn) {
                        this.openLoginModal();
                        return;
                    }
                    
                    if (!this.selectedColor || !this.selectedSize) {
                        alert('Please select both color and size');
                        return;
                    }
                    
                    const stock = this.getStockForColorAndSize(this.selectedColor.code, this.selectedSize);
                    if (stock <= 0) {
                        alert('Selected color and size combination is out of stock');
                        return;
                    }
                    
                    this.selectedProduct = product;
                    
                    // Set default checkout values
                    this.checkoutForm = {
                        fullName: this.currentUser.name,
                        email: this.currentUser.email,
                        phone: this.currentUser.phone || '',
                        province: '',
                        district: '',
                        city: '',
                        address: ''
                    };
                    
                    this.startPageTransition('payment');
                },
                
                proceedToCheckout() {
                    if (!this.isLoggedIn) {
                        this.openLoginModal();
                        return;
                    }
                    
                    if (this.cartItems.length === 0) {
                        alert('Your cart is empty');
                        return;
                    }
                    
                    // For simplicity, use the first item in cart
                    this.selectedProduct = this.cartItems[0];
                    this.selectedSize = this.cartItems[0].size;
                    this.selectedColor = this.cartItems[0].color;
                    
                    // Set default checkout values
                    this.checkoutForm = {
                        fullName: this.currentUser.name,
                        email: this.currentUser.email,
                        phone: this.currentUser.phone || '',
                        province: '',
                        district: '',
                        city: '',
                        address: ''
                    };
                    
                    this.cartOpen = false;
                    this.startPageTransition('payment');
                },
                
                placeOrder() {
                    // 1. Validate form
                    if (!this.checkoutForm.fullName || !this.checkoutForm.email || !this.checkoutForm.phone || 
                        !this.checkoutForm.province || !this.checkoutForm.district || !this.checkoutForm.city || 
                        !this.checkoutForm.address) {
                        alert('Please fill in all required fields');
                        return;
                    }

                    // 2. Determine the image source safely
                    let imageToSend = this.selectedProduct.frontImages[0];
                    
                    // CHECK: If the image is "data:image..." (uploaded file), it WON'T show in emails.
                    // We try to fallback to a placeholder if it detects a local file upload.
                    if (imageToSend && imageToSend.startsWith('data:')) {
                        console.warn("Warning: Base64 images (uploaded files) may not show in emails. Use HTTPS URLs.");
                    }

                    // 3. Prepare email data
                    const emailParams = {
                        customer_name: this.checkoutForm.fullName,
                        customer_email: this.checkoutForm.email,
                        customer_phone: this.checkoutForm.phone,
                        customer_address: this.checkoutForm.address,
                        customer_city: this.checkoutForm.city,
                        customer_district: this.checkoutForm.district,
                        customer_province: this.checkoutForm.province,
                        
                        // --- IMAGE FIX ---
                        // Ensure this variable matches what you put in your EmailJS Template: <img src="{{product_image}}" />
                        product_image: imageToSend, 
                        // -----------------

                        product_name: this.selectedProduct.name,
                        product_description: this.selectedProduct.description,
                        product_size: this.selectedSize,
                        product_color: this.selectedColor.name,
                        product_price: this.selectedProduct.price,
                        product_sale_price: this.selectedProduct.salePrice || 'None',
                        shipping_cost: this.shippingCost,
                        total_amount: (this.selectedProduct.salePrice || this.selectedProduct.price) + this.shippingCost,
                        payment_method: this.paymentMethod === 'card' ? 'Credit/Debit Card' : 
                                       this.paymentMethod === 'mobile' ? 'JazzCash/EasyPaisa' : 'Cash on Delivery',
                        order_date: new Date().toLocaleDateString(),
                        delivery_days: this.deliveryDays
                    };

                    // Show loading state
                    const confirmButton = typeof event !== 'undefined' ? event.target : null;
                    let originalText = '';
                    if(confirmButton) {
                        originalText = confirmButton.textContent;
                        confirmButton.textContent = 'Processing Order...';
                        confirmButton.disabled = true;
                    }

                    // 4. Send Email
                    emailjs.send('service_nunpcrh', 'template_mpjmyxw', emailParams)
                        .then((response) => {
                            console.log('Email sent successfully!', response.status, response.text);
                            alert('Order confirmed! Notification sent to admin.');
                            
                            // 5. Create Order for Database
                            const orderData = {
                                orderId: 'TRK-' + Date.now(), 
                                date: new Date().toISOString(),
                                items: [{
                                    id: this.selectedProduct.id,
                                    name: this.selectedProduct.name,
                                    image: this.selectedProduct.frontImages[0],
                                    size: this.selectedSize,
                                    color: this.selectedColor.name,
                                    price: this.selectedProduct.salePrice || this.selectedProduct.price
                                }],
                                total: (this.selectedProduct.salePrice || this.selectedProduct.price) + this.shippingCost,
                                status: 'processing',
                                shipping: this.checkoutForm,
                                userId: this.isLoggedIn ? this.currentUser.id : 'guest',
                                userEmail: this.isLoggedIn ? this.currentUser.email : this.checkoutForm.email
                            };
                            
                            return window.fs.addDoc(window.fs.collection(window.db, "orders"), orderData)
                                .then((docRef) => {
                                    this.userOrders.unshift({ id: docRef.id, ...orderData });
                                    this.startPageTransition('order-confirmation');
                                    this.updateProductStock();
                                    this.cartItems = [];
                                    this.cartCount = 0;
                                    if (this.currentUser.id) {
                                        localStorage.setItem(`trendtrove_cart_${this.currentUser.id}`, JSON.stringify([]));
                                    }
                                });
                        })
                        .catch((error) => {
                            console.error('Failed to process order:', error);
                            alert('Failed to process order. Please try again or contact support.');
                        })
                        .finally(() => {
                            if(confirmButton) {
                                confirmButton.textContent = originalText;
                                confirmButton.disabled = false;
                            }
                        });
                },
                sendEmailNotification() {
                    // In a real app, this would use Nodemailer or similar
                    console.log('Email sent with order details');
                },
                
                updateProductStock() {
                    // In a real app, this would update the database
                    console.log('Stock updated for product:', this.selectedProduct.name, 'size:', this.selectedSize, 'color:', this.selectedColor.name);
                },
                
                downloadPDF() {
                    // Create a new jsPDF instance
                    const { jsPDF } = window.jspdf;
                    const doc = new jsPDF();
                    
                    // Add content to the PDF
                    doc.setFontSize(20);
                    doc.setTextColor(42, 42, 42);
                    doc.text('TrendTrove - Order Confirmation', 20, 20);
                    
                    doc.setFontSize(12);
                    doc.text(`Order Date: ${new Date().toLocaleDateString()}`, 20, 35);
                    doc.text(`Order ID: TRK-${Date.now()}`, 20, 45);
                    
                    // Customer Information
                    doc.setFontSize(14);
                    doc.text('Customer Information:', 20, 65);
                    doc.setFontSize(10);
                    doc.text(`Name: ${this.checkoutForm.fullName}`, 20, 75);
                    doc.text(`Email: ${this.checkoutForm.email}`, 20, 82);
                    doc.text(`Phone: ${this.checkoutForm.phone}`, 20, 89);
                    doc.text(`Address: ${this.checkoutForm.address}, ${this.checkoutForm.city}, ${this.checkoutForm.district}, ${this.checkoutForm.province}`, 20, 96);
                    
                    // Order Details
                    doc.setFontSize(14);
                    doc.text('Order Details:', 20, 115);
                    doc.setFontSize(10);
                    doc.text(`Product: ${this.selectedProduct.name}`, 20, 125);
                    doc.text(`Size: ${this.selectedSize}`, 20, 132);
                    doc.text(`Color: ${this.selectedColor.name}`, 20, 139);
                    doc.text(`Price: PKR ${this.selectedProduct.salePrice || this.selectedProduct.price}`, 20, 146);
                    doc.text(`Shipping: PKR ${this.shippingCost}`, 20, 153);
                    doc.text(`Total: PKR ${(this.selectedProduct.salePrice || this.selectedProduct.price) + this.shippingCost}`, 20, 160);
                    
                    // Payment Method
                    doc.setFontSize(14);
                    doc.text('Payment Method:', 20, 175);
                    doc.setFontSize(10);
                    doc.text(`${this.paymentMethod === 'card' ? 'Credit/Debit Card' : this.paymentMethod === 'mobile' ? 'JazzCash/EasyPaisa' : 'Cash on Delivery'}`, 20, 185);
                    
                    // Delivery Information
                    doc.setFontSize(14);
                    doc.text('Delivery Information:', 20, 200);
                    doc.setFontSize(10);
                    doc.text(`Estimated Delivery: ${this.deliveryDays} days`, 20, 210);
                    
                    // Footer
                    doc.setFontSize(10);
                    doc.setTextColor(100, 100, 100);
                    doc.text('Thank you for shopping with TrendTrove!', 20, 230);
                    doc.text('For any queries, contact support@trendtrove.com', 20, 237);
                    
                    // Save the PDF
                    doc.save(`TrendTrove-Order-${Date.now()}.pdf`);
                },
                
                closeOrderConfirmation() {
                    this.startPageTransition('home');
                },
                
                openAddCategoryModal() {
                    this.addCategoryModalOpen = true;
                },

                openRemoveCategoryModal() {
                    this.removeCategoryModalOpen = true;
                },

                handleCategoryImageUpload(event) {
                    const file = event.target.files[0];
                    if (file) {
                        const reader = new FileReader();
                        reader.onload = (e) => {
                            this.newCategory.image = e.target.result;
                        };
                        reader.readAsDataURL(file);
                    }
                    event.target.value = '';
                },
                async addCategory() {
                    // 1. Validation (Same as original)
                    if (!this.newCategory.name || !this.newCategory.description || !this.newCategory.imageUrl) {
                        alert('Please fill in all fields and add an image URL');
                        return;
                    }
                
                    // 2. Prepare data
                    const categoryData = {
                        name: this.newCategory.name,
                        description: this.newCategory.description,
                        image: this.newCategory.imageUrl
                    };
                
                    // 3. Save to Firebase
                    try {
                        const docRef = await window.fs.addDoc(window.fs.collection(window.db, "categories"), categoryData);
                        
                        // Update local display
                        this.categories.push({
                            id: docRef.id, // Use real Firebase ID
                            ...categoryData
                        });
                
                        // 4. Reset form (Same as original)
                        this.newCategory = { name: '', description: '', imageUrl: '' };
                        this.addCategoryModalOpen = false;
                        alert('Category added successfully to Database!');
                
                    } catch (error) {
                        console.error("Error adding category: ", error);
                        alert("Error saving category: " + error.message);
                    }
                },
                async removeCategory() {
                    if (!this.categoryToRemove) {
                        this.showToast('Please select a category to remove', 'error');
                        return;
                    }
                    
                    // Check if products exist in this category
                    const productCount = this.getProductCountByCategory(this.categoryToRemove);
                    
                    if (confirm(`Are you sure? This will delete the category and ${productCount} products.`)) {
                        try {
                            // 1. Delete all products in this category from Firebase first
                            const productsToDelete = this.products.filter(p => p.category === this.categoryToRemove);
                            
                            for (const product of productsToDelete) {
                                await window.fs.deleteDoc(window.fs.doc(window.db, "products", product.id));
                            }
                
                            // 2. Delete the category itself from Firebase
                            await window.fs.deleteDoc(window.fs.doc(window.db, "categories", this.categoryToRemove));
                
                            // 3. Update UI
                            this.products = this.products.filter(product => product.category !== this.categoryToRemove);
                            this.categories = this.categories.filter(cat => cat.id !== this.categoryToRemove);
                            
                            this.categoryToRemove = '';
                            this.removeCategoryModalOpen = false;
                            this.showToast('Category and associated products deleted permanently!', 'success');
                
                        } catch (error) {
                            console.error("Error removing category:", error);
                            this.showToast('Error deleting data: ' + error.message, 'error');
                        }
                    }
                },
                async deleteCategory(categoryId) {
                    const productCount = this.getProductCountByCategory(categoryId);
                    if (productCount > 0) {
                        this.showToast(`Cannot delete: There are ${productCount} products in this category.`, 'error');
                        return;
                    }
                    if (confirm('Are you sure you want to delete this category?')) {
                        try {
                            // Delete from Firebase
                            await window.fs.deleteDoc(window.fs.doc(window.db, "categories", categoryId));
                            
                            // Delete from UI
                            this.categories = this.categories.filter(cat => cat.id !== categoryId);
                            this.showToast('Category deleted successfully!', 'success');
                        } catch (error) {
                            this.showToast('Error deleting category', 'error');
                        }
                    }
                },

                async editCategory(category) {
                    const newName = prompt('Enter new category name:', category.name);
                    if (newName && newName !== category.name) {
                        try {
                            // 1. Update Firebase
                            const categoryRef = window.fs.doc(window.db, "categories", category.id);
                            await window.fs.updateDoc(categoryRef, {
                                name: newName
                            });
                
                            // 2. Update UI
                            category.name = newName;
                            this.showToast('Category updated successfully!', 'success');
                        } catch (error) {
                            console.error("Error updating category:", error);
                            this.showToast('Error updating category', 'error');
                        }
                    }
                },

                getProductCountByCategory(categoryId) {
                    return this.products.filter(product => product.category === categoryId).length;
                },                
                openAddProductModal() {
                    this.addProductModalOpen = true;
                },
                
                openAddSaleModal() {
                    this.addSaleModalOpen = true;
                },
                
                openChangeCredentialsModal() {
                    this.changeCredentialsModalOpen = true;
                },
                
                handleFrontImageUpload(event) {
                    const files = event.target.files;
                    if (files) {
                        for (let i = 0; i < files.length; i++) {
                            const file = files[i];
                            const reader = new FileReader();
                            reader.onload = (e) => {
                                this.newProduct.frontImages.push(e.target.result);
                            };
                            reader.readAsDataURL(file);
                        }
                    }
                    // Reset the input
                    event.target.value = '';
                },
                
                handleDetailImageUpload(event) {
                    const files = event.target.files;
                    if (files) {
                        for (let i = 0; i < files.length; i++) {
                            const file = files[i];
                            const reader = new FileReader();
                            reader.onload = (e) => {
                                this.newProduct.detailImages.push(e.target.result);
                            };
                            reader.readAsDataURL(file);
                        }
                    }
                    // Reset the input
                    event.target.value = '';
                },
                
                removeFrontImage(index) {
                    this.newProduct.frontImages.splice(index, 1);
                },
                
                removeDetailImage(index) {
                    this.newProduct.detailImages.splice(index, 1);
                },
                
                async addSale() {
                    if (!this.saleProductId) {
                        alert('Please select a product');
                        return;
                    }
                    
                    const productIndex = this.products.findIndex(p => p.id == this.saleProductId);
                    
                    if (productIndex !== -1) {
                        try {
                            const newSalePrice = parseFloat(this.saleForm.salePrice);

                            // 1. Update Firebase Database
                            const productRef = window.fs.doc(window.db, "products", this.saleProductId);
                            await window.fs.updateDoc(productRef, {
                                salePrice: newSalePrice
                            });

                            // 2. Update Local UI
                            this.products[productIndex].salePrice = newSalePrice;
                            
                            // 3. Close Modal and Reset
                            this.addSaleModalOpen = false;
                            this.saleProductId = '';
                            this.saleForm = {
                                originalPrice: 0,
                                salePrice: 0
                            };
                            
                            this.showToast('Sale applied and saved to database!', 'success');

                        } catch (error) {
                            console.error("Error saving sale:", error);
                            alert("Failed to update database: " + error.message);
                        }
                    }
                },
                
                changeCredentials() {
                    // In a real app, this would update the admin credentials in the database
                    if (this.credentialsForm.currentEmail === 'admin@trendtrove.com' && 
                        this.credentialsForm.currentPassword === 'admin123') {
                        // Update credentials (in a real app, this would be stored securely)
                        alert('Admin credentials updated successfully!');
                        this.changeCredentialsModalOpen = false;
                        this.credentialsForm = {
                            currentEmail: '',
                            newEmail: '',
                            currentPassword: '',
                            newPassword: ''
                        };
                    } else {
                        alert('Current email or password is incorrect');
                    }
                },
                // --- EDIT PRODUCT METHODS START ---
                editProduct(product) {
                    // Create a deep copy to avoid editing the view directly before saving
                    this.editingProduct = JSON.parse(JSON.stringify(product));
                    // Ensure arrays exist
                    if (!this.editingProduct.frontImages) this.editingProduct.frontImages = [];
                    if (!this.editingProduct.detailImages) this.editingProduct.detailImages = [];
                    
                    this.editProductModalOpen = true;
                },

                addEditFrontImage() {
                    this.editingProduct.frontImages.push('');
                },

                removeEditFrontImage(index) {
                    this.editingProduct.frontImages.splice(index, 1);
                },

                addEditDetailImage() {
                    this.editingProduct.detailImages.push('');
                },

                removeEditDetailImage(index) {
                    this.editingProduct.detailImages.splice(index, 1);
                },

                async updateProduct() {
                    if (!this.editingProduct.name || !this.editingProduct.description) {
                        alert("Name and Description are required.");
                        return;
                    }

                    // Clean empty image strings
                    this.editingProduct.frontImages = this.editingProduct.frontImages.filter(url => url.trim() !== '');
                    this.editingProduct.detailImages = this.editingProduct.detailImages.filter(url => url.trim() !== '');

                    try {
                        // Reference to the document in Firestore
                        const productRef = window.fs.doc(window.db, "products", this.editingProduct.id);

                        // Update Firestore
                        await window.fs.updateDoc(productRef, {
                            name: this.editingProduct.name,
                            description: this.editingProduct.description,
                            price: parseFloat(this.editingProduct.price),
                            frontImages: this.editingProduct.frontImages,
                            detailImages: this.editingProduct.detailImages
                        });

                        // Update the local products array immediately so everyone sees changes
                        const index = this.products.findIndex(p => p.id === this.editingProduct.id);
                        if (index !== -1) {
                            // Merge existing product data with updates to preserve other fields (like stock)
                            this.products[index] = { ...this.products[index], ...this.editingProduct };
                        }

                        this.editProductModalOpen = false;
                        this.showToast('Product updated successfully and saved to Database!', 'success');

                    } catch (error) {
                        console.error("Error updating product:", error);
                        this.showToast('Error updating product: ' + error.message, 'error');
                    }
                },
                // --- EDIT PRODUCT METHODS END ---
                async deleteProduct(productId) {
                    if (confirm('Are you sure you want to delete this product?')) {
                        try {
                            // 1. Delete from Firebase Database
                            await window.fs.deleteDoc(window.fs.doc(window.db, "products", productId));
                            
                            // 2. Remove from local screen (UI)
                            this.products = this.products.filter(p => p.id !== productId);
                            
                            // 3. Show professional notification
                            this.showToast('Product deleted from database successfully!', 'success');
                        } catch (error) {
                            console.error("Error deleting product:", error);
                            this.showToast('Error deleting product: ' + error.message, 'error');
                        }
                    }
                },

            }
        }
        

        document.addEventListener('alpine:init', () => {
            Alpine.data('app', app);
        });
    </script>
    <style>
        .snowflake {
            position: fixed;
            top: -20px;
            z-index: 9999;
            color: #9cebff; /* Gold color */
            font-size: 1em;
            user-select: none;
            pointer-events: none;
            animation-name: fall;
            animation-timing-function: linear;
            text-shadow: 0 0 5px rgba(0,0,0,0.1);
        }
    
        @keyframes fall {
            0% { transform: translateY(0) translateX(0) rotate(0deg); opacity: 1; }
            100% { transform: translateY(100vh) translateX(100px) rotate(360deg); opacity: 0; }
        }
    </style>
    
    <script>
        document.addEventListener("DOMContentLoaded", function() {
            const snowContainer = document.createElement('div');
            snowContainer.id = 'snow-container';
            document.body.appendChild(snowContainer);
    
            function createSnowflake() {
                const snowflake = document.createElement('div');
                snowflake.classList.add('snowflake');
                snowflake.innerHTML = ''; 
                
                snowflake.style.left = Math.random() * 100 + 'vw';
                snowflake.style.animationDuration = Math.random() * 3 + 2 + 's'; // Slightly faster falling (2-5s)
                snowflake.style.opacity = Math.random();
                snowflake.style.fontSize = Math.random() * 10 + 10 + 'px';
                
                snowContainer.appendChild(snowflake);
    
                setTimeout(() => {
                    snowflake.remove();
                }, 5000);
            }
    
            // CHANGED: 50 means "create a snowflake every 50ms" (Heavy Snow)
            // Lower number = More snow
            setInterval(createSnowflake, 50); 
        });

    </script> 

    <div onclick="toggleMusic()" style="position: fixed; bottom: 20px; left: 20px; width: 50px; height: 50px; background: #d4af37; border-radius: 50%; display: flex; align-items: center; justify-content: center; cursor: pointer; box-shadow: 0 4px 15px rgba(0,0,0,0.4); z-index: 2147483647;">
        <i id="music-icon" class="fas fa-volume-mute text-white" style="font-size: 20px;"></i>
    </div>

    <audio id="bgMusic" loop>
        <source src="bg-music.mp3" type="audio/mpeg">
        Your browser does not support the audio element.
    </audio>

    <script>
        const audio = document.getElementById('bgMusic');
        const icon = document.getElementById('music-icon');
        audio.volume = 0.4; // Initial volume at 40%

        function toggleMusic() {
            if (audio.paused) {
                audio.play();
                icon.className = "fas fa-volume-up text-white";
            } else {
                audio.pause();
                icon.className = "fas fa-volume-mute text-white";
            }
        }

        // BROWSER BYPASS: Sound starts on the first click anywhere on the page
        // This is necessary because Cloudflare/Chrome/Safari block auto-audio.
        document.addEventListener('click', function() {
            if (audio.paused) {
                audio.play().then(() => {
                    icon.className = "fas fa-volume-up text-white";
                }).catch(err => {
                    console.log("Autoplay blocked, user must click the gold button manually.");
                });
            }
        }, { once: true });
    </script>

</body>
</html>